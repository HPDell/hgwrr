<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>hgwrr • hgwrr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="hgwrr">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">hgwrr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5-0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/hgwrr.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/introduction.html">HGWR Model and How to Use It</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/HPDell/hgwrr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>hgwrr</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/HPDell/hgwrr/blob/master/vignettes/hgwrr.Rmd" class="external-link"><code>vignettes/hgwrr.Rmd</code></a></small>
      <div class="d-none name"><code>hgwrr.Rmd</code></div>
    </div>

    
    
<p>The package <strong>hgwrr</strong> is used to calibrate Hierarchical
and Geographically Weighted Regression (HGWR) model on spatial data. It
requires the spatial hierarchical structure in the data; i.e., samples
are grouped by their locations. All the variables are either in the
group level or sample level. For the group-level variables, they can
have fixed effects (globally constant) or spatially weighted effects
(varying with the location). For the sample-level variables, they can
have fixed effects or random effects (varying among groups). We note the
fixed effects as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>,
the group-level spatially weighted (GLSW) effects as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>γ</mi><annotation encoding="application/x-tex">\gamma</annotation></semantics></math>,
and sample-level random (SLR) effects as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>μ</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>.
The HGWR model consists of these three kinds of effects and estimates
the three kinds of effects considering the spatial heterogeneity.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/HPDell/hgwrr/" class="external-link">hgwrr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: sf</span></span>
<span><span class="co">#&gt; Linking to GEOS 3.10.2, GDAL 3.4.1, PROJ 8.2.1; sf_use_s2() is TRUE</span></span></code></pre></div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<div class="section level3">
<h3 id="model-calibration">Model calibration<a class="anchor" aria-label="anchor" href="#model-calibration"></a>
</h3>
<p>To calibrate a HGWR model, use the function <code><a href="../reference/hgwr.html">hgwr()</a></code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/hgwr.html">hgwr</a></span><span class="op">(</span></span>
<span>  <span class="va">formula</span>, <span class="va">data</span>, <span class="va">...</span>, bw <span class="op">=</span> <span class="st">"CV"</span>,</span>
<span>  kernel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gaussian"</span>, <span class="st">"bisquared"</span><span class="op">)</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.01</span>, eps_iter <span class="op">=</span> <span class="fl">1e-6</span>, eps_gradient <span class="op">=</span> <span class="fl">1e-6</span>,</span>
<span>  max_iters <span class="op">=</span> <span class="fl">1e6</span>, max_retries <span class="op">=</span> <span class="fl">1e6</span>,</span>
<span>  ml_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"D_Only"</span>, <span class="st">"D_Beta"</span><span class="op">)</span>, verbose <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The following is explanation of some important parameters.</p>
<div class="section level4">
<h4 id="formula">
<code>formula</code><a class="anchor" aria-label="anchor" href="#formula"></a>
</h4>
<p>This parameter specifies the model form. Recall that the three kinds
of effects are GLSW, fixed, and SLR effects. They are specified in
different parts of the formula.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">response</span> <span class="op">~</span> <span class="fu">L</span><span class="op">(</span><span class="va">GLSW</span><span class="op">)</span> <span class="op">+</span> <span class="va">fixed</span> <span class="op">+</span> <span class="op">(</span><span class="va">SLR</span> <span class="op">|</span> <span class="va">group</span><span class="op">)</span></span></code></pre></div>
<p>In the formula, <code>L()</code> is used to mark some effects as GLSW
effects, and <code>( | group)</code> is used to set the SLR effects and
grouping indicator. Only group-level variables can have GLSW
effects.</p>
</div>
<div class="section level4">
<h4 id="data">
<code>data</code><a class="anchor" aria-label="anchor" href="#data"></a>
</h4>
<p><strong><code>sf</code> objects</strong></p>
<p>From version 0.3-1, this parameter supports <code>sf</code> objects.
In this case, no further arguments in <code>...</code> are required.
Here is an example.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">wuhan.hp</span><span class="op">)</span></span>
<span><span class="va">m_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hgwr.html">hgwr</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">Price</span> <span class="op">~</span> <span class="fu">L</span><span class="op">(</span><span class="va">d.Water</span> <span class="op">+</span> <span class="va">d.Commercial</span><span class="op">)</span> <span class="op">+</span> <span class="va">BuildingArea</span> <span class="op">+</span> <span class="op">(</span><span class="va">Floor.High</span> <span class="op">|</span> <span class="va">group</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">wuhan.hp</span>,</span>
<span>  bw <span class="op">=</span> <span class="fl">299</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong><code>data.frame</code> objects</strong></p>
<p>If the data is a normal <code>data.frame</code> object, an extra
argument <code>coords</code> is required to specify the coordinates of
each group. Note that the row order of <code>coords</code> needs to
match that of the <code>group</code> variable. Here is an example.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">multisampling</span><span class="op">)</span></span>
<span><span class="va">m_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hgwr.html">hgwr</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="fu">L</span><span class="op">(</span><span class="va">g1</span> <span class="op">+</span> <span class="va">g2</span><span class="op">)</span> <span class="op">+</span> <span class="va">x1</span> <span class="op">+</span> <span class="op">(</span><span class="va">z1</span> <span class="op">|</span> <span class="va">group</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">multisampling</span><span class="op">$</span><span class="va">data</span>,</span>
<span>  coords <span class="op">=</span> <span class="va">multisampling</span><span class="op">$</span><span class="va">coords</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="bw-and-kernel">
<code>bw</code> and <code>kernel</code><a class="anchor" aria-label="anchor" href="#bw-and-kernel"></a>
</h4>
<p>Argument <code>bw</code> is the bandwidth used to estimate GLSW
effects. It can be either of the following options:</p>
<ul>
<li>A integer value representing the number of nearest neighbours.</li>
<li>
<code>"CV"</code> letting the algorithm select one.</li>
</ul>
<p>Argument <code>kernel</code> is the kernel function used to estimate
GLSW effects. Currently, there are only two choices:
<code>"gaussian"</code> and <code>"bisquared"</code>.</p>
</div>
</div>
<div class="section level3">
<h3 id="results">Results<a class="anchor" aria-label="anchor" href="#results"></a>
</h3>
<p>The output of returned object of <code><a href="../reference/hgwr.html">hgwr()</a></code> shows the
estimates of the effects.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m_df</span></span>
<span><span class="co">#&gt; Hierarchical and geographically weighted regression model</span></span>
<span><span class="co">#&gt; =========================================================</span></span>
<span><span class="co">#&gt; Formula: y ~ L(g1 + g2) + x1 + (z1 | group)</span></span>
<span><span class="co">#&gt;  Method: Back-fitting and Maximum likelihood</span></span>
<span><span class="co">#&gt;    Data: multisampling$data</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Global Fixed Effects</span></span>
<span><span class="co">#&gt; -------------------</span></span>
<span><span class="co">#&gt;  Intercept        x1 </span></span>
<span><span class="co">#&gt;   4.057598  0.966088 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Group-level Spatially Weighted Effects</span></span>
<span><span class="co">#&gt; -------------------</span></span>
<span><span class="co">#&gt; Bandwidth: 9.000016 (nearest neighbours)</span></span>
<span><span class="co">#&gt;  Coefficient        Min  1st Quartile     Median  3rd Quartile        Max </span></span>
<span><span class="co">#&gt;    Intercept  -2.477395     -2.355703  -2.121756     -1.877999  -1.692284 </span></span>
<span><span class="co">#&gt;           g1   5.557560      6.303393   7.248665      7.500396   8.628861 </span></span>
<span><span class="co">#&gt;           g2  -0.868120      0.069715   0.958127      1.318092   1.551972 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sample-level Random Effects</span></span>
<span><span class="co">#&gt; --------------</span></span>
<span><span class="co">#&gt;    Groups       Name  Std.Dev.      Corr </span></span>
<span><span class="co">#&gt;     group  Intercept  1.920528           </span></span>
<span><span class="co">#&gt;                   z1  1.920528  0.000000 </span></span>
<span><span class="co">#&gt;  Residual             1.920528           </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Other Information</span></span>
<span><span class="co">#&gt; -----------------</span></span>
<span><span class="co">#&gt; Number of Obs: 484</span></span>
<span><span class="co">#&gt;        Groups: group , 16</span></span></code></pre></div>
<p>And the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> method shows some diagnostic
information.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m_df</span><span class="op">)</span></span>
<span><span class="co">#&gt; Hierarchical and geographically weighted regression model</span></span>
<span><span class="co">#&gt; =========================================================</span></span>
<span><span class="co">#&gt; Formula: y ~ L(g1 + g2) + x1 + (z1 | group)</span></span>
<span><span class="co">#&gt;  Method: Back-fitting and Maximum likelihood</span></span>
<span><span class="co">#&gt;    Data: multisampling$data</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter Estimates</span></span>
<span><span class="co">#&gt; -------------------</span></span>
<span><span class="co">#&gt; Fixed effects:</span></span>
<span><span class="co">#&gt;             Estimated     Sd. Err     t.val  Pr(&gt;|t|)      </span></span>
<span><span class="co">#&gt;  Intercept  4.0575982  0.25449128  15.94396         0  *** </span></span>
<span><span class="co">#&gt;         x1  0.9660875  0.04676336  20.65907         0  *** </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Bandwidth: 9.000016 (nearest neighbours)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; GLSW effects:</span></span>
<span><span class="co">#&gt;             Mean Est.  Mean Sd.    ***     **      *      . </span></span>
<span><span class="co">#&gt;  Intercept  -2.103489  0.565900  75.0%  25.0%   0.0%   0.0% </span></span>
<span><span class="co">#&gt;         g1   6.948511  3.266527   0.0%   6.2%  62.5%  31.2% </span></span>
<span><span class="co">#&gt;         g2   0.719551  3.296013   0.0%   0.0%   0.0%   0.0% </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; SLR effects:</span></span>
<span><span class="co">#&gt;    Groups       Name       Mean  Std.Dev.      Corr </span></span>
<span><span class="co">#&gt;     group  Intercept  -0.000000  1.920528           </span></span>
<span><span class="co">#&gt;                   z1   0.005523  1.920528  0.000000 </span></span>
<span><span class="co">#&gt;  Residual              0.000000  1.920528           </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Diagnostics</span></span>
<span><span class="co">#&gt; -----------</span></span>
<span><span class="co">#&gt;  rsquared  0.647039 </span></span>
<span><span class="co">#&gt;    logLik       NaN </span></span>
<span><span class="co">#&gt;       AIC       NaN </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Scaled Residuals</span></span>
<span><span class="co">#&gt; ----------------</span></span>
<span><span class="co">#&gt;        Min         1Q     Median        3Q       Max </span></span>
<span><span class="co">#&gt;  -5.454886  -1.216360  -0.073301  1.247373  5.327542 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Other Information</span></span>
<span><span class="co">#&gt; -----------------</span></span>
<span><span class="co">#&gt; Number of Obs: 484</span></span>
<span><span class="co">#&gt;        Groups: group , 16</span></span></code></pre></div>
<p>The significance level of spatial heterogeneity in GLSW effects can
be tested with the following codes.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m_df</span>, test_hetero <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="co">#&gt; Hierarchical and geographically weighted regression model</span></span>
<span><span class="co">#&gt; =========================================================</span></span>
<span><span class="co">#&gt; Formula: y ~ L(g1 + g2) + x1 + (z1 | group)</span></span>
<span><span class="co">#&gt;  Method: Back-fitting and Maximum likelihood</span></span>
<span><span class="co">#&gt;    Data: multisampling$data</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter Estimates</span></span>
<span><span class="co">#&gt; -------------------</span></span>
<span><span class="co">#&gt; Fixed effects:</span></span>
<span><span class="co">#&gt;             Estimated     Sd. Err     t.val  Pr(&gt;|t|)      </span></span>
<span><span class="co">#&gt;  Intercept  4.0575982  0.25449128  15.94396         0  *** </span></span>
<span><span class="co">#&gt;         x1  0.9660875  0.04676336  20.65907         0  *** </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Bandwidth: 9.000016 (nearest neighbours)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; GLSW effects:</span></span>
<span><span class="co">#&gt;             Mean Est.  Mean Sd.    ***     **      *      . </span></span>
<span><span class="co">#&gt;  Intercept  -2.103489  0.565900  75.0%  25.0%   0.0%   0.0% </span></span>
<span><span class="co">#&gt;         g1   6.948511  3.266527   0.0%   6.2%  62.5%  31.2% </span></span>
<span><span class="co">#&gt;         g2   0.719551  3.296013   0.0%   0.0%   0.0%   0.0% </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; GLSW effect spatial heterogeneity:</span></span>
<span><span class="co">#&gt;             Sd. Est.        t0    Min. t    Max. t  Pr(t&gt;t0)      </span></span>
<span><span class="co">#&gt;  Intercept  0.268012  0.253645  0.031230  0.247266  0.000000  *** </span></span>
<span><span class="co">#&gt;         g1  0.854397  0.809485  0.166221  0.805451  0.000000  *** </span></span>
<span><span class="co">#&gt;         g2  0.722266  0.691518  0.142386  0.673427  0.000000  *** </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; SLR effects:</span></span>
<span><span class="co">#&gt;    Groups       Name       Mean  Std.Dev.      Corr </span></span>
<span><span class="co">#&gt;     group  Intercept  -0.000000  1.920528           </span></span>
<span><span class="co">#&gt;                   z1   0.005523  1.920528  0.000000 </span></span>
<span><span class="co">#&gt;  Residual              0.000000  1.920528           </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Diagnostics</span></span>
<span><span class="co">#&gt; -----------</span></span>
<span><span class="co">#&gt;  rsquared  0.647039 </span></span>
<span><span class="co">#&gt;    logLik       NaN </span></span>
<span><span class="co">#&gt;       AIC       NaN </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Scaled Residuals</span></span>
<span><span class="co">#&gt; ----------------</span></span>
<span><span class="co">#&gt;        Min         1Q     Median        3Q       Max </span></span>
<span><span class="co">#&gt;  -5.454886  -1.216360  -0.073301  1.247373  5.327542 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Other Information</span></span>
<span><span class="co">#&gt; -----------------</span></span>
<span><span class="co">#&gt; Number of Obs: 484</span></span>
<span><span class="co">#&gt;        Groups: group , 16</span></span></code></pre></div>
<p>Some other methods are provided.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">m_df</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Intercept       g1          g2        x1         z1</span></span>
<span><span class="co">#&gt; 1 0.8738330 7.721070  0.06175178 0.9660875 -0.1931416</span></span>
<span><span class="co">#&gt; 2 3.3857847 6.335641  1.52880964 0.9660875  0.2870040</span></span>
<span><span class="co">#&gt; 3 0.8175705 7.476406  0.84953501 0.9660875  1.2706663</span></span>
<span><span class="co">#&gt; 4 2.4934172 7.398369  0.86755062 0.9660875 -0.5998743</span></span>
<span><span class="co">#&gt; 5 5.9128656 8.628861 -0.86812008 0.9660875 -1.4658340</span></span>
<span><span class="co">#&gt; 6 0.6129129 6.271144  1.35855547 0.9660875  0.6958578</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">m_df</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2.6579678 2.5879538 3.9085387 0.8865106 3.9384948 2.6547040</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span><span class="va">m_df</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -1.4267713  0.1274905 -1.9104633  2.8806623  0.5553585 -1.9290357</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="further-reading">Further reading<a class="anchor" aria-label="anchor" href="#further-reading"></a>
</h2>
<div class="section level3">
<h3 id="model-comparison">Model comparison<a class="anchor" aria-label="anchor" href="#model-comparison"></a>
</h3>
<ul>
<li>Article <a href="https://hpdell.github.io/hgwrr/articles/introduction.html" class="external-link"><em>HGWR
Model and How to Use It</em></a> in this site compares HGWR with GWR and
HLM on the simulation data.</li>
<li>This <a href="https://doi.org/10.4230/LIPIcs.GIScience.2023.39" class="external-link">short paper</a>
compares HGWR, GWR, MGWR, and HLM with a simulation data. All the codes
are shown in this <a href="https://hpdell.github.io/GIScience-Materials/posts/HGWR/" class="external-link">site</a>.</li>
</ul>
</div>
<div class="section level3">
<h3 id="mathematical-basis">Mathematical basis<a class="anchor" aria-label="anchor" href="#mathematical-basis"></a>
</h3>
<p>The following papers shows more details about the mathematical basis
about the HGWR model.</p>
<ul>
<li>Yigong Hu, Richard Harris, Richard Timmerman, and Binbin Lu. A
Hierarchical and Geographically Weighted Regression Model and Its
Backfitting Maximum Likelihood Estimator (Short Paper). In 12th
International Conference on Geographic Information Science (GIScience
2023). Leibniz International Proceedings in Informatics (LIPIcs), Volume
277, pp. 39:1-39:6, Schloss Dagstuhl – Leibniz-Zentrum für Informatik
(2023) <a href="https://journals.sagepub.com/doi/10.1177/23998083211063885" class="external-link">DOI</a>
</li>
<li>Hu, Yigong, Lu, Binbin, Ge, Yong, Dong, Guanpeng, 2022. Uncovering
spatial heterogeneity in real estate prices via combined hierarchical
linear model and geographically weighted regression. Environment and
Planning B: Urban Analytics and City Science. <a href="https://doi.org/10.4230/LIPIcs.GIScience.2023.39" class="external-link">DOI</a>
</li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Yigong Hu.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
