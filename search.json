[{"path":[]},{"path":"/articles/hgwrr.html","id":"model-calibration","dir":"Articles","previous_headings":"Usage","what":"Model calibration","title":"hgwrr","text":"calibrate HGWR model, use function hgwr(). following explanation important parameters.","code":"hgwr(   formula, data, ..., bw = \"CV\",   kernel = c(\"gaussian\", \"bisquared\"),   alpha = 0.01, eps_iter = 1e-6, eps_gradient = 1e-6,   max_iters = 1e6, max_retries = 1e6,   ml_type = c(\"D_Only\", \"D_Beta\"), verbose = 0 )"},{"path":"/articles/hgwrr.html","id":"formula","dir":"Articles","previous_headings":"Usage > Model calibration","what":"formula","title":"hgwrr","text":"parameter specifies model form. Recall three kinds effects GLSW, fixed, SLR effects. specified different parts formula. formula, L() used mark effects GLSW effects, ( | group) used set SLR effects grouping indicator. group-level variables can GLSW effects.","code":"response ~ L(GLSW) + fixed + (SLR | group)"},{"path":"/articles/hgwrr.html","id":"data","dir":"Articles","previous_headings":"Usage > Model calibration","what":"data","title":"hgwrr","text":"sf objects version 0.3-1, parameter supports sf objects. case, arguments ... required. example. data.frame objects data normal data.frame object, extra argument coords required specify coordinates group. Note row order coords needs match group variable. example.","code":"data(wuhan.hp) m_sf <- hgwr(   formula = Price ~ L(d.Water + d.Commercial) + BuildingArea + (Floor.High | group),   data = wuhan.hp,   bw = 299 ) data(mulsam.test) m_df <- hgwr(   formula = y ~ L(g1 + g2) + x1 + (z1 | group),   data = mulsam.test$data,   coords = mulsam.test$coords )"},{"path":"/articles/hgwrr.html","id":"bw-and-kernel","dir":"Articles","previous_headings":"Usage > Model calibration","what":"bw and kernel","title":"hgwrr","text":"Argument bw bandwidth used estimate GLSW effects. can either following options: integer value representing number nearest neighbours. \"CV\" letting algorithm select one. Argument kernel kernel function used estimate GLSW effects. Currently, two choices: \"gaussian\" \"bisquared\".","code":""},{"path":"/articles/hgwrr.html","id":"results","dir":"Articles","previous_headings":"Usage","what":"Results","title":"hgwrr","text":"output returned object hgwr() shows estimates effects. summary() method shows diagnostic information. significance level spatial heterogeneity GLSW effects can tested following codes. methods provided.","code":"m_df #> Hierarchical and geographically weighted regression model #> ========================================================= #> Formula: y ~ L(g1 + g2) + x1 + (z1 | group) #>  Method: Back-fitting and Maximum likelihood #>    Data: mulsam.test$data #>  #> Fixed Effects #> ------------- #>  Intercept        x1  #>   4.056760  1.967648  #>  #> Group-level Spatially Weighted Effects #> -------------------------------------- #> Bandwidth: 9.35816 (nearest neighbours) #>  #> Coefficient estimates: #>  Coefficient        Min  1st Quartile     Median  3rd Quartile        Max  #>    Intercept  -2.769060     -2.708289  -2.356463     -2.225995  -2.022646  #>           g1   0.876505      1.253144   1.702822      1.939969   2.336628  #>           g2   1.082775      1.279601   1.424307      1.607909   1.722892  #>  #> Sample-level Random Effects #> --------------------------- #>    Groups       Name  Std.Dev.      Corr  #>     group  Intercept  1.032962            #>                   z1  1.032962  0.000000  #>  Residual             1.032962            #>  #> Other Information #> ----------------- #> Number of Obs: 873 #>        Groups: group , 25 summary(m_df) #> Hierarchical and geographically weighted regression model #> ========================================================= #> Formula: y ~ L(g1 + g2) + x1 + (z1 | group) #>  Method: Back-fitting and Maximum likelihood #>    Data: mulsam.test$data #>  #> Parameter Estimates #> ------------------- #> Fixed effects: #>             Estimated   Sd. Err      t.val  Pr(>|t|)       #>  Intercept   4.056760  0.203079  19.976270  0.000000  ***  #>         x1   1.967648  0.033827  58.168658  0.000000  ***  #>  #> Bandwidth: 9.35816 (nearest neighbours) #>  #> GLSW effects: #>             Mean Est.  Mean Sd.     ***    **     *     .  #>  Intercept  -2.421973  0.251700  100.0%  0.0%  0.0%  0.0%  #>         g1   1.641343  1.823056    0.0%  0.0%  0.0%  0.0%  #>         g2   1.435709  1.506236    0.0%  0.0%  0.0%  0.0%  #>  #> SLR effects: #>    Groups       Name      Mean  Std.Dev.      Corr  #>     group  Intercept  0.000000  1.032962            #>                   z1  1.869552  1.032962  0.000000  #>  Residual             0.088510  1.032962            #>  #>  #> Diagnostics #> ----------- #>  rsquared  0.905066  #>    logLik       NaN  #>       AIC       NaN  #>  #> Scaled Residuals #> ---------------- #>        Min         1Q    Median        3Q       Max  #>  -3.408088  -0.576387  0.100854  0.734105  3.036324  #>  #> Other Information #> ----------------- #> Number of Obs: 873 #>        Groups: group , 25 summary(m_df, test_hetero = T) #> Hierarchical and geographically weighted regression model #> ========================================================= #> Formula: y ~ L(g1 + g2) + x1 + (z1 | group) #>  Method: Back-fitting and Maximum likelihood #>    Data: mulsam.test$data #>  #> Parameter Estimates #> ------------------- #> Fixed effects: #>             Estimated   Sd. Err      t.val  Pr(>|t|)       #>  Intercept   4.056760  0.203079  19.976270  0.000000  ***  #>         x1   1.967648  0.033827  58.168658  0.000000  ***  #>  #> Bandwidth: 9.35816 (nearest neighbours) #>  #> GLSW effects: #>             Mean Est.  Mean Sd.     ***    **     *     .  #>  Intercept  -2.421973  0.251700  100.0%  0.0%  0.0%  0.0%  #>         g1   1.641343  1.823056    0.0%  0.0%  0.0%  0.0%  #>         g2   1.435709  1.506236    0.0%  0.0%  0.0%  0.0%  #>  #> SLR effects: #>    Groups       Name      Mean  Std.Dev.      Corr  #>     group  Intercept  0.000000  1.032962            #>                   z1  1.869552  1.032962  0.000000  #>  Residual             0.088510  1.032962            #>  #>  #> Diagnostics #> ----------- #>  rsquared  0.905066  #>    logLik       NaN  #>       AIC       NaN  #>  #> Scaled Residuals #> ---------------- #>        Min         1Q    Median        3Q       Max  #>  -3.408088  -0.576387  0.100854  0.734105  3.036324  #>  #> Other Information #> ----------------- #> Number of Obs: 873 #>        Groups: group , 25 head(coef(m_df)) #>   Intercept       g1       g2       x1       z1 #> 1 0.9143066 2.336628 1.633698 1.967648 1.817139 #> 2 1.1269566 1.932128 1.626517 1.967648 2.305685 #> 3 1.8867179 2.027690 1.659433 1.967648 2.251592 #> 4 1.1245250 2.265663 1.536906 1.967648 1.591036 #> 5 1.7726751 2.219179 1.607909 1.967648 1.698600 #> 6 0.7008420 2.082628 1.421329 1.967648 1.855599 head(fitted(m_df)) #> [1]  3.659871  4.317510  6.929765  1.768491  0.511762 -2.023591 head(residuals(m_df)) #> [1] -0.5654830 -0.7380541  0.9197850  0.5707894 -0.3850239 -0.1648946"},{"path":[]},{"path":"/articles/hgwrr.html","id":"model-comparison","dir":"Articles","previous_headings":"Further reading","what":"Model comparison","title":"hgwrr","text":"Article HGWR Model Use site compares HGWR GWR HLM simulation data. short paper compares HGWR, GWR, MGWR, HLM simulation data. codes shown site.","code":""},{"path":"/articles/hgwrr.html","id":"mathematical-basis","dir":"Articles","previous_headings":"Further reading","what":"Mathematical basis","title":"hgwrr","text":"following papers shows details mathematical basis HGWR model. Yigong Hu, Richard Harris, Richard Timmerman, Binbin Lu. Hierarchical Geographically Weighted Regression Model Backfitting Maximum Likelihood Estimator (Short Paper). 12th International Conference Geographic Information Science (GIScience 2023). Leibniz International Proceedings Informatics (LIPIcs), Volume 277, pp. 39:1-39:6, Schloss Dagstuhl – Leibniz-Zentrum für Informatik (2023) DOI Hu, Yigong, Lu, Binbin, Ge, Yong, Dong, Guanpeng, 2022. Uncovering spatial heterogeneity real estate prices via combined hierarchical linear model geographically weighted regression. Environment Planning B: Urban Analytics City Science. DOI","code":""},{"path":[]},{"path":"/articles/introduction.html","id":"what-is-hgwr-model","dir":"Articles","previous_headings":"Introduction to HGWR Model","what":"What is HGWR model?","title":"HGWR Model and How to Use It","text":"Hierarchical Geographically Weighted Regression, shorted HGWR, spatial modelling method designed data spatial hierarchical structures. Just name implies, combination Hierarchical Linear Model [HLM, also known Multilevel Model, @Raudenbush-1993] Geographically Weighted Regression [GWR, @BrunsdonFotheringham-1996]. model, spatial effects divided three types: global fixed, local fixed random. Formally, expressed y=Gγ+Xβ+Zμ+ϵ y = G\\gamma + X\\beta + Z\\mu + \\epsilon  yy dependent variable, GG group level independent variables, γ\\gamma local fixed effects, XX also group level independent variables, β\\beta global fixed effects, ZZ individual level independent variables, μ\\mu random effects, ϵ\\epsilon individual errors.","code":""},{"path":"/articles/introduction.html","id":"why-hgwr-model","dir":"Articles","previous_headings":"Introduction to HGWR Model","what":"Why HGWR model?","title":"HGWR Model and How to Use It","text":"know, hierarchical structure commonly existing spatial data. example, cities can grouped provinces higher-level administrative district belong ; house prices may share factors block; students one school different access education resources another school. dealing type data, usually choose HLM address within-group homogeneity -group heterogeneity. usually two types variables: group-level variables sample-level variables. formal ones used describe properties groups (provinces, blocks schools); latter ones observations individual samples (cities, houses students). effect sample-level variables similar groups, thus modelled fixed coefficients (effects). others, modelled individually, .e., random effects. However, group-level variables, can modelled fixed effects. spatial data, encounter problems. According Tobler’s first law Geography “Everything related everything else, near things related distant things” [@Tobler-1970]. model calibrated equally weighted samples, spatial heterogeneity overlooked [@FotheringhamBrunsdon-2002]. Thus, requires us distinguish “local fixed effects” “global fixed effects” discover spatial heterogeneity group-level variables. GWR Multiscale GWR [@FotheringhamYang-2017, LuBrunsdon-2017] dealing data hierarchical structures, GWR problematic [@HuLu-2022]. know GWR calibrate model unique coefficients sample borrowing data neighbours. uses parameter “bandwidth” control many neighbours included. samples hierarchically structured, everything works well. However, just imagine situation like Figure 1. two samples red color blue color, take number neighbours, actually spatial extents . extreme cases, spatial extends samples small hold one two location, large enough. lead failure bandwidth optimization reduce reliability optimized bandwidth. solve problems mentioned , need use HGWR model. able modelling spatial hierarchical structure spatial heterogeneity simultaneously. Examples can show works well spatial hierarchical data.","code":""},{"path":"/articles/introduction.html","id":"modelling-with-hgwr-model","dir":"Articles","previous_headings":"","what":"Modelling with HGWR Model","title":"HGWR Model and How to Use It","text":"R package hgwrr built calibrating HGWR model. section, going show use .","code":""},{"path":"/articles/introduction.html","id":"installation","dir":"Articles","previous_headings":"Modelling with HGWR Model","what":"Installation","title":"HGWR Model and How to Use It","text":"Package hgwrr available CRAN. Simply type following codes install . download latest released source package run following command install package. Note RTools required Windows.","code":"install.packages(\"hgwrr\") R CMD INSTALL hgwrr_0.5-0.tar.gz"},{"path":"/articles/introduction.html","id":"usage","dir":"Articles","previous_headings":"Modelling with HGWR Model","what":"Usage","title":"HGWR Model and How to Use It","text":"going show usage hgwrr package simulated data. First, need load package R session. can calibrate HGWR model via hgwr() function. first five arguments mandatory. formula accepts formula object R. format follows lme4 package. two types effects: fixed effects random effects, use following format specify : data accepts data.frame sf object R. variables specified formula extracted data. (needed data type data.frame) coords accepts matrix 2 columns. row longitude latitude group. bw accepts integer numeric number specify bandwidth used geographically weighted process. Currently can adaptive bandwidth. arguments optional used control backfitting maximum likelihood algorithm. occasions default values fine. default values cause problems want change , please check documentation function hgwr() information.","code":"library(hgwrr) #> Loading required package: sf #> Linking to GEOS 3.10.2, GDAL 3.4.1, PROJ 8.2.1; sf_use_s2() is TRUE #> Loading required package: MASS hgwr(   formula, data, coords, bw,   alpha = 0.01, eps_iter = 1e-06, eps_gradient = 1e-06, max_iters = 1e+06,   max_retries = 10, ml_type = HGWR_ML_TYPE_D_ONLY, verbose = 0 ) dependent ~ L(local.fixed) + fixed + (random | group)"},{"path":"/articles/introduction.html","id":"example-a-small-simulated-data-set","dir":"Articles","previous_headings":"Modelling with HGWR Model","what":"Example: A Small Simulated Data Set","title":"HGWR Model and How to Use It","text":"example used show usage package test whether works. don’t care good fitness model data set. data set “mulsam.test” provided package, y dependent variable, g1 g2 two group-level variables, z1 x1 two sample-level variables, group labels groups belong , U, V longitude latitude coordinate values groups. regards g1 g2 local fixed effects, x1 global fixed effects z1 random effects. can calibrate HGWR model like output model shows estimations global fixed effects, summary local fixed effects. Also standard deviations random effects correlation coefficients . can look coefficient estimations. ggplot2 packages, can create figures.  can also convert spatial data use tmap visualize.  can also fetch fitted residuals. summary() function give statistical information model. current stage, pseudo R2R^2 available. future, diagnostic information provided package.","code":"data(mulsam.test) head(mulsam.test$data) #>            y        g1         g2         x1         z1 group #> 1  3.0943882 0.0443617 -0.0486926  0.9265996  0.4943128     1 #> 2  3.5794558 0.0443617 -0.0486926  0.5094696  1.3079015     1 #> 3  7.8495496 0.0443617 -0.0486926  1.6624003  1.4970410     1 #> 4  2.3392806 0.0443617 -0.0486926 -0.3305220  0.8147027     1 #> 5  0.1267381 0.0443617 -0.0486926  1.5099312 -1.8697888     1 #> 6 -2.1884856 0.0443617 -0.0486926 -1.9505113  0.4820295     1 head(mulsam.test$coords) #>   u  v #> 1 0  9 #> 2 2 19 #> 3 3 17 #> 4 4  2 #> 5 5 10 #> 6 6  1 ms_hgwr <- hgwr(   formula = y ~ L(g1 + g2) + x1 + (z1 | group),   data = mulsam.test$data,   coords = mulsam.test$coords,   bw = 10, alpha = 1e-16 ) ms_hgwr #> Hierarchical and geographically weighted regression model #> ========================================================= #> Formula: y ~ L(g1 + g2) + x1 + (z1 | group) #>  Method: Back-fitting and Maximum likelihood #>    Data: mulsam.test$data #>  #> Fixed Effects #> ------------- #>  Intercept        x1  #>   1.852190  1.967644  #>  #> Group-level Spatially Weighted Effects #> -------------------------------------- #> Bandwidth: 10 (nearest neighbours) #>  #> Coefficient estimates: #>  Coefficient        Min  1st Quartile     Median  3rd Quartile       Max  #>    Intercept  -0.549094     -0.439522  -0.151433     -0.024133  0.178044  #>           g1   0.909293      1.253143   1.692616      1.927313  2.310056  #>           g2   1.083410      1.279953   1.415744      1.594576  1.693768  #>  #> Sample-level Random Effects #> --------------------------- #>    Groups       Name  Std.Dev.      Corr  #>     group  Intercept  1.033171            #>                   z1  1.033171  0.000000  #>  Residual             1.033171            #>  #> Other Information #> ----------------- #> Number of Obs: 873 #>        Groups: group , 25 coef(ms_hgwr) #>    Intercept        g1       g2       x1       z1 #> 1  0.9233672 2.3100563 1.623094 1.967644 1.817155 #> 2  1.1355688 1.9273133 1.623457 1.967644 2.305716 #> 3  1.8948376 1.9681553 1.625849 1.967644 2.251604 #> 4  1.1327246 2.2656619 1.536906 1.967644 1.590994 #> 5  1.7883252 2.1834680 1.594576 1.967644 1.698679 #> 6  0.7060594 2.0168951 1.399640 1.967644 1.855324 #> 7  1.0109699 1.9266816 1.355484 1.967644 1.105044 #> 8  1.7495857 1.8658473 1.670593 1.967644 1.021006 #> 9  0.8418062 1.8149658 1.279953 1.967644 2.980240 #> 10 1.3535790 1.9201790 1.362606 1.967644 2.081303 #> 11 1.0394353 1.9399671 1.480825 1.967644 1.999491 #> 12 1.8167418 1.8022871 1.693768 1.967644 2.303986 #> 13 2.4239639 1.5126602 1.612656 1.967644 1.471564 #> 14 0.5334871 1.6926159 1.237340 1.967644 1.676205 #> 15 1.3043111 1.6881432 1.264833 1.967644 1.454624 #> 16 1.3370861 1.5843740 1.238710 1.967644 2.374940 #> 17 1.5039024 1.5804393 1.525840 1.967644 1.042542 #> 18 2.0337854 1.2531427 1.376711 1.967644 1.454729 #> 19 1.9575950 1.2613191 1.415744 1.967644 2.718663 #> 20 2.5267858 1.2438959 1.500855 1.967644 1.902474 #> 21 1.4363110 1.1675786 1.354417 1.967644 1.672610 #> 22 2.6255900 1.0711151 1.543638 1.967644 3.185923 #> 23 2.6121111 0.9099629 1.168313 1.967644 1.382425 #> 24 2.2433299 0.9092926 1.083410 1.967644 1.755667 #> 25 3.1624476 0.9708449 1.183679 1.967644 1.635566 library(ggplot2) ms_hgwr_coef <- as.data.frame(cbind(mulsam.test$coords, coef(ms_hgwr))) ggplot(ms_hgwr_coef, aes(u, v, color = g1)) + geom_point() +   coord_fixed() + theme_bw() library(sf) library(tmap) #> Breaking News: tmap 3.x is retiring. Please test v4, e.g. with #> remotes::install_github('r-tmap/tmap') ms_hgwr_coef_sf <- st_as_sf(ms_hgwr_coef,                             coords = names(mulsam.test$coords),                             crs = 27700) tm_shape(ms_hgwr_coef_sf) + tm_dots(col = c(\"g1\", \"g2\"), size = 0.5) head(data.frame(   real = mulsam.test$data$y,   fitted = fitted(ms_hgwr),   residuals = residuals(ms_hgwr) )) #>         real    fitted  residuals #> 1  3.0943882  3.668274 -0.5738854 #> 2  3.5794558  4.325927 -0.7464712 #> 3  7.8495496  6.938180  0.9113695 #> 4  2.3392806  1.776904  0.5623768 #> 5  0.1267381  0.520124 -0.3933859 #> 6 -2.1884856 -2.015177 -0.1733083 summary(ms_hgwr) #> Hierarchical and geographically weighted regression model #> ========================================================= #> Formula: y ~ L(g1 + g2) + x1 + (z1 | group) #>  Method: Back-fitting and Maximum likelihood #>    Data: mulsam.test$data #>  #> Parameter Estimates #> ------------------- #> Fixed effects: #>             Estimated   Sd. Err      t.val  Pr(>|t|)       #>  Intercept   1.852190  0.203079   9.120541  0.000000  ***  #>         x1   1.967644  0.033827  58.168539  0.000000  ***  #>  #> Bandwidth: 10 (nearest neighbours) #>  #> GLSW effects: #>             Mean Est.  Mean Sd.   ***    **     *      .  #>  Intercept  -0.208441  0.247059  0.0%  0.0%  4.0%  24.0%  #>         g1   1.631474  1.795246  0.0%  0.0%  0.0%   0.0%  #>         g2   1.430116  1.476570  0.0%  0.0%  0.0%   0.0%  #>  #> SLR effects: #>    Groups       Name      Mean  Std.Dev.      Corr  #>     group  Intercept  0.000000  1.033171            #>                   z1  1.869539  1.033171  0.000000  #>  Residual             0.079964  1.033171            #>  #>  #> Diagnostics #> ----------- #>  rsquared     0.905207  #>    logLik  -118.467314  #>       AIC   261.985064  #>  #> Scaled Residuals #> ---------------- #>        Min         1Q    Median        3Q       Max  #>  -3.416380  -0.584726  0.092501  0.725766  3.028003  #>  #> Other Information #> ----------------- #> Number of Obs: 873 #>        Groups: group , 25"},{"path":"/articles/introduction.html","id":"example-large-scale-simulated-data","dir":"Articles","previous_headings":"Modelling with HGWR Model","what":"Example: Large Scale Simulated Data","title":"HGWR Model and How to Use It","text":"former example, 873 observations 25 groups. adequate enough get precises estimations. , going use large scale simulated data set show performance HGWR model. true value coefficients already known (stored variable msl_beta), closeness estimated true values practical performance metric. data set provided . structure similar data mulsam.test. data, also regards g1 g2 two group-level variables, z1 x1 two sample-level variables, group labels groups belong , U, V longitude latitude coordinate values groups. calibrate HGWR model. data large (21434 observations), may take time get results.","code":"data(multisampling) head(multisampling$data) #>           y         g1        g2         x1         z1 group #> 1  4.274065 -0.1541009 0.1088925  3.1685285 -0.6264538     1 #> 2  0.952104 -0.1541009 0.1088925 -0.0310156  0.1836433     1 #> 3 -2.277711 -0.1541009 0.1088925 -1.0921285 -0.8356286     1 #> 4  1.210245 -0.1541009 0.1088925 -0.9828463  1.5952808     1 #> 5  4.546979 -0.1541009 0.1088925  1.7193320  0.3295078     1 #> 6 -5.204828 -0.1541009 0.1088925 -1.8466449 -0.8204684     1 head(multisampling$coords) #>   u v #> 1 0 0 #> 2 0 1 #> 3 0 2 #> 4 0 3 #> 5 0 4 #> 6 0 5 msl_beta <- multisampling$beta head(msl_beta) #>   Intercept g1        g2 x1       z1 #> 1 0.3495151  0 0.2519548  2 2.463117 #> 2 0.4287200  0 0.3142063  2 2.633550 #> 3 0.3296451  0 0.3843869  2 1.252887 #> 4 0.2671497  0 0.4613005  2 1.905223 #> 5 0.4647590  0 0.5430762  2 1.908053 #> 6 0.2715478  0 0.6271901  2 1.425105 msl_hgwr <- hgwr(   formula = y ~ L(g1 + g2) + x1 + (z1 | group),   data = multisampling$data,   coords = multisampling$coords,   bw = 128, kernel = \"bisquared\", alpha = 1e-16 ) msl_hgwr #> Hierarchical and geographically weighted regression model #> ========================================================= #> Formula: y ~ L(g1 + g2) + x1 + (z1 | group) #>  Method: Back-fitting and Maximum likelihood #>    Data: multisampling$data #>  #> Fixed Effects #> ------------- #>  Intercept        x1  #>   1.993571  2.013951  #>  #> Group-level Spatially Weighted Effects #> -------------------------------------- #> Bandwidth: 128 (nearest neighbours) #>  #> Coefficient estimates: #>  Coefficient        Min  1st Quartile     Median  3rd Quartile       Max  #>    Intercept  -1.365347     -0.546013  -0.000998      0.568186  1.408843  #>           g1   0.383958      1.101335   1.560858      2.425391  3.599753  #>           g2   0.777366      1.371943   1.751608      2.461359  3.572902  #>  #> Sample-level Random Effects #> --------------------------- #>    Groups       Name  Std.Dev.      Corr  #>     group  Intercept  1.037299            #>                   z1  1.037299  0.000000  #>  Residual             1.037299            #>  #> Other Information #> ----------------- #> Number of Obs: 21434 #>        Groups: group , 625"},{"path":"/articles/introduction.html","id":"fitness-assessment","dir":"Articles","previous_headings":"Modelling with HGWR Model > Example: Large Scale Simulated Data","what":"Fitness Assessment","title":"HGWR Model and How to Use It","text":"check estimations intercept, g1, g2 z1 via scatter plots.  addition scatter plots, root mean squared errors (RMSE) mean absolute errors estimations true values also useful assess fitting performance.","code":"library(dplyr) #>  #> Attaching package: 'dplyr' #> The following object is masked from 'package:MASS': #>  #>     select #> The following objects are masked from 'package:stats': #>  #>     filter, lag #> The following objects are masked from 'package:base': #>  #>     intersect, setdiff, setequal, union library(purrr) coef(msl_hgwr) %>%   select(Intercept, g1, g2, z1) %>%    list(label = names(.), Truth = msl_beta[names(.)], Estimated = .) %>%   pmap_df(data.frame) %>%   mutate(label = factor(label, levels = c(\"Intercept\", \"g1\", \"g2\", \"z1\"))) %>%   ggplot(aes(x = Truth, y = Estimated)) + geom_point() +     coord_fixed() + scale_y_continuous(limits = c(-25, 25)) +     facet_grid(cols = vars(label)) +     theme_bw() msl_hgwr_err <- coef(msl_hgwr) %>%   select(Intercept, g1, g2, z1, x1) %>% {     as.data.frame(rbind(       MAE = map2_dbl(msl_beta, ., ~ mean(abs(.x - .y))),       RMSE = map2_dbl(msl_beta, ., ~ sqrt(mean((.x - .y)^2)))     ))   } msl_hgwr_err #>      Intercept        g1        g2        x1        z1 #> MAE  0.1677028 0.4417195 0.3350320 0.4179894 0.3952250 #> RMSE 0.2127406 0.5485650 0.4073874 0.5191893 0.4937104"},{"path":"/articles/introduction.html","id":"comparison-of-hgwr-gwr-and-hlm","dir":"Articles","previous_headings":"Modelling with HGWR Model > Example: Large Scale Simulated Data","what":"Comparison of HGWR, GWR and HLM","title":"HGWR Model and How to Use It","text":"comparison, can also calibrate GWR model HLM model look fitting performance. GWR model can calibrated following codes. also HLM model calibrated following codes. bar plot helpful compare fitness three models.  Note figure limited scale y axis make bar x1 z1 obvious. actual numbers labelled bars. can say HGWR best fitness among three models. able give precise estimations local fixed effects. can estimate global fixed effects also random effects precisely HLM , precisely GWR .","code":"enable_parallel = Sys.info()['sysname'] != 'Darwin' parallel_method = ifelse(enable_parallel, \"omp\", FALSE) parallel_arg = ifelse(enable_parallel, 0, NA) ### GWR model library(GWmodel) #> Loading required package: robustbase #> Loading required package: sp #> Loading required package: Rcpp #> Welcome to GWmodel version 2.4-2. msl_gwr_data <- multisampling$data coordinates(msl_gwr_data) <- with(multisampling, coords[data$group, ]) ##### Get optimized bandwidth via golden minimization algorithm. msl_gwr_bw <- 265  # The bandiwdth is pre-optimised to save time. ##### Calibrate GWR model with optimized bandwidth. msl_gwr <- gwr.basic(   formula = y ~ g1 + g2 + x1 + z1,   data = msl_gwr_data,   bw = msl_gwr_bw,   adaptive = TRUE,   parallel.method = parallel_method,   parallel.arg = parallel_arg ) #### Get coefficient estimations. #### As samples in one group have equal estimations, #### we use mean value of each group to represent them. msl_gwr_coef <- cbind(msl_gwr$SDF@data, group = msl_gwr_data$group) %>%   select(Intercept, g1, g2, x1, z1, group) %>%   group_by(group) %>%   summarise_all(mean) ##### Calculate RMSE and MAE of estimations. msl_gwr_err <- msl_gwr_coef %>%   select(Intercept, g1, g2, z1, x1) %>% {     as.data.frame(rbind(       MAE = map2_dbl(msl_beta, ., ~ mean(abs(.x - .y))),       RMSE = map2_dbl(msl_beta, ., ~ sqrt(mean((.x - .y)^2)))     ))   } msl_gwr_err #>      Intercept       g1        g2        x1        z1 #> MAE  0.1827751 1.024012 0.9715697 0.2332346 0.3964786 #> RMSE 0.2448687 1.532527 1.4101019 0.2964659 0.4994751 library(lme4) #> Loading required package: Matrix msl_hlm <- lmer(   formula = y ~ g1 + g2 + x1 + (z1 | group),   data = multisampling$data ) msl_hlm_coef <- coef(msl_hlm)$group colnames(msl_hlm_coef)[which(colnames(msl_hlm_coef) == \"(Intercept)\")] <- \"Intercept\" msl_hlm_err <- msl_hlm_coef %>%   select(Intercept, g1, g2, z1, x1) %>% {     as.data.frame(rbind(       MAE = map2_dbl(msl_beta, ., ~ mean(abs(.x - .y))),       RMSE = map2_dbl(msl_beta, ., ~ sqrt(mean((.x - .y)^2)))     ))   } msl_hlm_err #>      Intercept       g1        g2        x1        z1 #> MAE  0.2454883 1.073194 0.8378061 0.4266994 0.3952242 #> RMSE 0.3279763 1.237473 0.9856770 0.5300526 0.4937105 list(HGWR = msl_hgwr_err, GWR = msl_gwr_err, HLM = msl_hlm_err) %>%   map2_dfr(., names(.), function(x, nx) {     map2_dfr(x, colnames(x), function(i, ni) {       data.frame(Coefficient = ni, Label = rownames(x), Value = i)     }) %>% cbind(Algorithm = nx, .)   }) %>%   ggplot(aes(x = Coefficient, y = Value, group = Algorithm, fill = Algorithm)) +     geom_col(position = \"dodge\") +     geom_text(aes(label = round(Value, 2), y = pmin(Value, 10), vjust = -0.2),               position = position_dodge(0.9)) +     facet_grid(rows = vars(Label)) +     scale_y_continuous(limits = c(0, 10), oob = scales::squish,                        expand = expansion(add = c(0.5, 1))) +     theme_bw()"},{"path":"/articles/introduction.html","id":"case-study-impact-factors-of-house-price-in-wuhan","dir":"Articles","previous_headings":"Modelling with HGWR Model","what":"Case Study: Impact Factors of House Price in Wuhan","title":"HGWR Model and How to Use It","text":"fitness HGWR demonstrated simulation data, thing applying collected data sets. going use case study show usage HGWR type data. data set provided wuhan.hp package.  data set, collected 2018, 19599 properties located 19599 communities. observation, fields house properties, locational neighbourhood variables. details, distances nearby educational resources (kindergartens, primary schools, middle schools, high schools, universities), commercial areas (business districts, shopping malls supermarkets), transportation facilities (metro stations bus stations), rivers, lakes, green lands. following figure shows distribution properties, table gives information available variables. variable selection process [@HuLu-2022] suggests us use following variables build HGWR model: Fee d.Water d.Commercial d.PrimarySchool d.Kindergarten BuildingArea Floor.High going append variable d.ShoppingMall usually concerned customers researchers. regards locational Fee local fixed effects, BuildingArea global fixed effects Floor.High random effects. can calibrate HGWR model following codes.","code":"data(wuhan.hp) plot(wuhan.hp[\"Price\"]) whhp_hgwr <- hgwr(   formula = Price ~ L(d.Water + d.Commercial + d.Kindergarten + d.PrimarySchool) +             Fee + BuildingArea + d.ShoppingMall + (Floor.High | group),   data = wuhan.hp,   bw = \"CV\" ) whhp_hgwr #> Hierarchical and geographically weighted regression model #> ========================================================= #> Formula:  #> Price ~ L(d.Water + d.Commercial + d.Kindergarten + d.PrimarySchool) +   #>     Fee + BuildingArea + d.ShoppingMall + (Floor.High | group) #>  Method: Back-fitting and Maximum likelihood #>    Data: wuhan.hp #>  #> Fixed Effects #> ------------- #>  Intercept       Fee  BuildingArea  d.ShoppingMall  #>   9.905824  0.176803     -0.020361       -0.002869  #>  #> Group-level Spatially Weighted Effects #> -------------------------------------- #> Bandwidth: 562 (nearest neighbours) #>  #> Coefficient estimates: #>      Coefficient        Min  1st Quartile     Median  3rd Quartile        Max  #>        Intercept  -0.255465     -0.217436  -0.196229     -0.160231  -0.136330  #>          d.Water  -2.455754     -2.132142  -1.918264     -1.767405  -1.485196  #>     d.Commercial  -4.637517     -4.456327  -4.275131     -3.973180  -3.840621  #>   d.Kindergarten  -0.035458     -0.031036  -0.027930     -0.025192  -0.021800  #>  d.PrimarySchool  -0.041803     -0.040628  -0.039498     -0.038174  -0.037094  #>  #> Sample-level Random Effects #> --------------------------- #>    Groups        Name  Std.Dev.       Corr  #>     group   Intercept  0.151359             #>            Floor.High  0.079724  -0.022868  #>  Residual              0.081436             #>  #> Other Information #> ----------------- #> Number of Obs: 19599 #>        Groups: group , 776"},{"path":"/articles/introduction.html","id":"coefficient-visualization","dir":"Articles","previous_headings":"Modelling with HGWR Model > Case Study: Impact Factors of House Price in Wuhan","what":"Coefficient Visualization","title":"HGWR Model and How to Use It","text":"can also make maps visualize estimated coefficients. Boundary data Wuhan provided. GeoJSON format can loaded package rgdal. coefficients, can simply combine coordinates houses. coefficients, coordinates groups can one--one matched. visualize coefficients estimations basemap.  figure, can see BuildingArea regarded global fixed effects, samples one estimations. Floor.High regarded random effects, group unique estimation spatial relationship can seen. local fixed effects, estimations seems locally related. suggested first law geography. Besides, spatial heterogeneity also obvious estimations.","code":"wuhan <- sf::read_sf(\"https://raw.githubusercontent.com/hpdell/hgwr/docs/data/wuhan.geojson\") wuhan_hp_groups <- st_centroid(aggregate(wuhan.hp, by = list(wuhan.hp$group), mean)) wuhp_coef_sf <- cbind(coef(whhp_hgwr), st_coordinates(wuhan_hp_groups)) %>%   st_as_sf(coords = c(\"X\", \"Y\"), crs = 4547) wh_basemap <- tm_shape(wuhan) + tm_polygons(col = \"white\") with(whhp_hgwr$effects, c(local.fixed, random, global.fixed, \"Intercept\")) %>%   map(function(var) {     wh_basemap +       tm_shape(wuhp_coef_sf, is.master = T) +       tm_dots(col = var, size = 0.1, midpoint = 0,               palette = \"-RdBu\", legend.col.reverse = T)   }) %>%     tmap_arrange(ncol = 3)"},{"path":"/articles/introduction.html","id":"residual-analysis","dir":"Articles","previous_headings":"Modelling with HGWR Model > Case Study: Impact Factors of House Price in Wuhan","what":"Residual Analysis","title":"HGWR Model and How to Use It","text":"Via standard function residuals(), access residuals estimated model. can visualize combining summary statistics residuals coordinates. example, created map showing mean residual group together standard deviation.  can also convey global Moran test residuals find well estimated points. p-value Moran’s value, can find although suggested reject null hypothesis, global spatial autocorrelation weak take effects. Additionally, local Moran test also useful.  can seen residuals spatially clustered. showing spatial clusters locate near boundary study area.","code":"whhp_hgwr_res <- data.frame(   residuals = residuals(whhp_hgwr),   group = wuhan.hp$group ) %>%   group_by(group) %>%   summarise(res.abs.mean = mean(abs(residuals)),             res.sd = sd(residuals)) %>%   cbind(st_coordinates(wuhan_hp_groups)) %>%   st_as_sf(coords = c(\"X\", \"Y\"), crs = 4547) wh_basemap +   tm_shape(whhp_hgwr_res, is.master = T) +   tm_dots(col = \"res.abs.mean\", size = \"res.sd\", midpoint = 0,           palette = \"-RdBu\", legend.col.reverse = T) library(spdep) #> Loading required package: spData #> To access larger datasets in this package, install the spDataLarge #> package with: `install.packages('spDataLarge', #> repos='https://nowosad.github.io/drat/', type='source')` whhp_hgwr_res_listw <- st_coordinates(whhp_hgwr_res) %>%   knearneigh(k = 20) %>% knn2nb() %>% nb2listw() %>% listw2U() moran.test(whhp_hgwr_res$res.abs.mean, whhp_hgwr_res_listw) #>  #>  Moran I test under randomisation #>  #> data:  whhp_hgwr_res$res.abs.mean   #> weights: whhp_hgwr_res_listw     #>  #> Moran I statistic standard deviate = 6.1948, p-value = 2.918e-10 #> alternative hypothesis: greater #> sample estimates: #> Moran I statistic       Expectation          Variance  #>      0.0639606679     -0.0012903226      0.0001109483 whhp_hgwr_res_localmoran <- localmoran(whhp_hgwr_res$res.abs.mean, whhp_hgwr_res_listw) wh_basemap +   tm_shape(cbind(whhp_hgwr_res, whhp_hgwr_res_localmoran), is.master = T) +   tm_dots(col = \"Ii\", size = 0.2, palette = \"-RdBu\", style = \"quantile\",           midpoint = 0, title = \"Local Moran\") whhp_hgwr_res$res_c <- scale(whhp_hgwr_res$res.abs.mean, scale = F) whhp_hgwr_res$lmoran_c <- scale(whhp_hgwr_res_localmoran[,1], scale = F) whhp_hgwr_res$quadrant <- with(whhp_hgwr_res, {   quadrant <- integer(length(res_c))   quadrant[res_c < 0 & lmoran_c < 0] <- 1   quadrant[res_c < 0 & lmoran_c > 0] <- 2   quadrant[res_c > 0 & lmoran_c < 0] <- 3   quadrant[res_c > 0 & lmoran_c > 0] <- 4   quadrant[whhp_hgwr_res_localmoran[,5] > 0.1] <- 0   as.factor(quadrant) }) LISA_palette <- list(   \"Insignificant\" = \"green\", \"Low-Low\" = \"darkblue\", \"Low-High\" = \"blue\",   \"High-Low\" = \"red\", \"High-High\" = \"darkred\" ) tm_layout(aes.palette = \"cat\") +   wh_basemap +   tm_shape(whhp_hgwr_res, is.master = T) +   tm_dots(col = \"quadrant\", size = 0.2,           palette = as.vector(unlist(LISA_palette)),           labels = names(LISA_palette))"},{"path":[]},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Yigong Hu. Maintainer.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Hu Y, Harris R, Timmerman R (2024). hgwrr: Hierarchical Geographically Weighted Regression. R package version 0.5-0, https://hpdell.github.io/hgwrr/, https://github.com/HPDell/hgwrr/.","code":"@Manual{,   title = {hgwrr: Hierarchical and Geographically Weighted Regression},   author = {Yigong Hu and Richard Harris and Richard Timmerman},   year = {2024},   note = {R package version 0.5-0, https://hpdell.github.io/hgwrr/},   url = {https://github.com/HPDell/hgwrr/}, }"},{"path":"/index.html","id":"hgwrr","dir":"","previous_headings":"","what":"Hierarchical and Geographically Weighted Regression","title":"Hierarchical and Geographically Weighted Regression","text":"package provides R interfaces calibrate Hierarchical Geographically Weighted Regression (HGWR) model.","code":""},{"path":"/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Hierarchical and Geographically Weighted Regression","text":"package now CRAN. want install latest version GitHub, note packages relies submodule hpdell/hgwr. install_github() devtools package probably working. Instead, ’s better recursively clone package.","code":"install.packages(\"hgwrr\") git clone --recursive https://github.com/hpdell/hgwrr R CMD INSTALL hgwrr"},{"path":"/index.html","id":"basic-usage","dir":"","previous_headings":"","what":"Basic Usage","title":"Hierarchical and Geographically Weighted Regression","text":"quick example showing works. information, please read article. full example.","code":"library(hgwrr) data(multisampling) hgwr(   formula = y ~ L(g1 + g2) + x1 + (z1 | group),   data = multisampling$data,   coords = multisampling$coords,   bw = 10 )"},{"path":"/index.html","id":"reference","dir":"","previous_headings":"","what":"Reference","title":"Hierarchical and Geographically Weighted Regression","text":"Hu, Yigong, Lu, Binbin, Ge, Yong, Dong, Guanpeng, 2022. Uncovering spatial heterogeneity real estate prices via combined hierarchical linear model geographically weighted regression. Environment Planning B: Urban Analytics City Science. DOI Yigong Hu, Richard Harris, Richard Timmerman, Binbin Lu. Hierarchical Geographically Weighted Regression Model Backfitting Maximum Likelihood Estimator (Short Paper). 12th International Conference Geographic Information Science (GIScience 2023). Leibniz International Proceedings Informatics (LIPIcs), Volume 277, pp. 39:1-39:6, Schloss Dagstuhl – Leibniz-Zentrum für Informatik (2023) DOI","code":""},{"path":"/reference/coef.hgwrm.html","id":null,"dir":"Reference","previous_headings":"","what":"Get estimated coefficients. — coef.hgwrm","title":"Get estimated coefficients. — coef.hgwrm","text":"Get estimated coefficients.","code":""},{"path":"/reference/coef.hgwrm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get estimated coefficients. — coef.hgwrm","text":"","code":"# S3 method for class 'hgwrm' coef(object, ...)"},{"path":"/reference/coef.hgwrm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get estimated coefficients. — coef.hgwrm","text":"object hgwrm object returned hgwr(). ... Parameter received functions.","code":""},{"path":"/reference/coef.hgwrm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get estimated coefficients. — coef.hgwrm","text":"DataFrame object consists estimated coefficients.","code":""},{"path":[]},{"path":"/reference/fitted.hgwrm.html","id":null,"dir":"Reference","previous_headings":"","what":"Get fitted response. — fitted.hgwrm","title":"Get fitted response. — fitted.hgwrm","text":"Get fitted response.","code":""},{"path":"/reference/fitted.hgwrm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get fitted response. — fitted.hgwrm","text":"","code":"# S3 method for class 'hgwrm' fitted(object, ...)"},{"path":"/reference/fitted.hgwrm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get fitted response. — fitted.hgwrm","text":"object hgwrm object returned hgwr(). ... Parameter received functions.","code":""},{"path":"/reference/fitted.hgwrm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get fitted response. — fitted.hgwrm","text":"vector consists fitted response values.","code":""},{"path":[]},{"path":"/reference/hgwr.html","id":null,"dir":"Reference","previous_headings":"","what":"Hierarchical and Geographically Weighted Regression — spatial_hetero_test.hgwrm","title":"Hierarchical and Geographically Weighted Regression — spatial_hetero_test.hgwrm","text":"Hierarchical Linear Model (HLM) group-level geographically weighted effects.","code":""},{"path":"/reference/hgwr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Hierarchical and Geographically Weighted Regression — spatial_hetero_test.hgwrm","text":"","code":"# S3 method for class 'hgwrm' spatial_hetero_test(   x,   round = 99,   statistic = stat_glsw,   parallel = FALSE,   verbose = 0,   ... )  hgwr(   formula,   data,   ...,   bw = \"CV\",   kernel = c(\"gaussian\", \"bisquared\"),   alpha = 0.01,   eps_iter = 1e-06,   eps_gradient = 1e-06,   max_iters = 1e+06,   max_retries = 1e+06,   ml_type = c(\"D_Only\", \"D_Beta\"),   f_test = FALSE,   verbose = 0 )  # S3 method for class 'sf' hgwr(   formula,   data,   ...,   bw = \"CV\",   kernel = c(\"gaussian\", \"bisquared\"),   alpha = 0.01,   eps_iter = 1e-06,   eps_gradient = 1e-06,   max_iters = 1e+06,   max_retries = 1e+06,   ml_type = c(\"D_Only\", \"D_Beta\"),   f_test = FALSE,   verbose = 0 )  # S3 method for class 'data.frame' hgwr(   formula,   data,   ...,   coords,   bw = \"CV\",   kernel = c(\"gaussian\", \"bisquared\"),   alpha = 0.01,   eps_iter = 1e-06,   eps_gradient = 1e-06,   max_iters = 1e+06,   max_retries = 1e+06,   ml_type = c(\"D_Only\", \"D_Beta\"),   f_test = FALSE,   verbose = 0 )  hgwr_fit(   formula,   data,   coords,   bw = c(\"CV\", \"AIC\"),   kernel = c(\"gaussian\", \"bisquared\"),   alpha = 0.01,   eps_iter = 1e-06,   eps_gradient = 1e-06,   max_iters = 1e+06,   max_retries = 1e+06,   ml_type = c(\"D_Only\", \"D_Beta\"),   f_test = FALSE,   verbose = 0 )"},{"path":"/reference/hgwr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Hierarchical and Geographically Weighted Regression — spatial_hetero_test.hgwrm","text":"x hgwrm object round number times sampling model. statistic function used calculate statistics original data bootstrapped data. Default variance standardlised GLSW estimates. parallel TRUE, use furrr package parallel. verbose integer value. Determine log level. Possible values : 0 log printed. 1 logs back-fitting printed. 2 logs printed. ... arguments specified type data. formula formula. structure similar lmer function lme4 package. Models can specified following form:   information, please see formula subsection details. data data. bw numeric value. value bandwidth \"CV\". stage function support adaptive bandwidth. unit must number nearest neighbours. \"CV\" specified, algorithm automatically select optimized bandwidth value. kernel character value. specify kernel function used GWR part. Possible values gaussian Gaussian kernel function \\(k(d)=\\exp\\left(-\\frac{d^2}{b^2}\\right)\\) bisquared Bi-squared kernel function. \\(d<b\\) \\(k(d)=\\left(1-\\frac{d^2}{b^2}\\right)^2\\) else \\(k(d)=0\\) alpha numeric value. size first trial step maximum likelihood algorithm. eps_iter numeric value. Terminate threshold back-fitting. eps_gradient numeric value. Terminate threshold maximum likelihood algorithm. max_iters integer value. maximum iteration. max_retries integer value. algorithm tends diverge, stops automatically trying max_retires times. ml_type integer value. Represent maximum likelihood algorithm used. Possible values : D_Only \\(D\\) specified maximum likelihood. D_Beta \\(D\\) \\(beta\\) specified maximum likelihood. f_test logical value. Determine whether F test GLSW effects. f_test=TURE, f_test item returned object showing F test GLSW effect. coords 2-column matrix. consists coordinates group.","code":"response ~ L(local.fixed) + global.fixed + (random | group)"},{"path":"/reference/hgwr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Hierarchical and Geographically Weighted Regression — spatial_hetero_test.hgwrm","text":"list describing model following fields. gamma Coefficients group-level spatially weighted effects. beta Coefficients fixed effects. mu Coefficients sample-level random effects. D Variance-covariance matrix sample-level random effects. sigma Variance errors. effects list including names effects. call Calling function. frame DataFrame object sent call. frame.parsed Variables extracted data. groups Unique group labels extracted data. f_test list F test GLSW effects. exists f_test=TRUE. item contains F value, degrees freedom numerator, degrees freedom denominator, \\(p\\) value \\(F>F_\\alpha\\).","code":""},{"path":[]},{"path":"/reference/hgwr.html","id":"effect-specification-in-formula","dir":"Reference","previous_headings":"","what":"Effect Specification in Formula","title":"Hierarchical and Geographically Weighted Regression — spatial_hetero_test.hgwrm","text":"HGWR model, three types effects specified formula argument: Group-level spatially weighted (GLSW, aka. local fixed) effects Effects wrapped functional symbol L. Sample-level random (SLR) effects Effects specified outside functional symbol L left symbol |. Fixed effects effects example, following formula example function written   g1 g2 GLSW effects, x1 fixed effects, z1 SLR effects grouped group indicator group. Note SLR effects can specified !","code":"y ~ L(g1 + g2) + x1 + (z1 | group)"},{"path":"/reference/hgwr.html","id":"functions","dir":"Reference","previous_headings":"","what":"Functions","title":"Hierarchical and Geographically Weighted Regression — spatial_hetero_test.hgwrm","text":"spatial_hetero_test(hgwrm): Test spatial heterogeneity bootstrapping. hgwr_fit(): Fit HGWR model","code":""},{"path":"/reference/hgwr.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Hierarchical and Geographically Weighted Regression — spatial_hetero_test.hgwrm","text":"","code":"data(mulsam.test) hgwr(   formula = y ~ L(g1 + g2) + x1 + (z1 | group),   data = mulsam.test$data,   coords = mulsam.test$coords,   bw = 10 ) #> Hierarchical and geographically weighted regression model #> ========================================================= #> Formula: y ~ L(g1 + g2) + x1 + (z1 | group) #>  Method: Back-fitting and Maximum likelihood #>    Data: mulsam.test$data #>  #> Fixed Effects #> ------------- #>  Intercept        x1  #>   1.852190  1.967644  #>  #> Group-level Spatially Weighted Effects #> -------------------------------------- #> Bandwidth: 10 (nearest neighbours) #>  #> Coefficient estimates: #>  Coefficient        Min  1st Quartile     Median  3rd Quartile       Max  #>    Intercept  -0.549094     -0.439522  -0.151433     -0.024133  0.178044  #>           g1   0.909293      1.253143   1.692616      1.927313  2.310056  #>           g2   1.083410      1.279953   1.415744      1.594576  1.693768  #>  #> Sample-level Random Effects #> --------------------------- #>    Groups       Name  Std.Dev.      Corr  #>     group  Intercept  1.033171            #>                   z1  1.033171  0.000000  #>  Residual             1.033171            #>  #> Other Information #> ----------------- #> Number of Obs: 873 #>        Groups: group , 25  mod_Ftest <- hgwr(   formula = y ~ L(g1 + g2) + x1 + (z1 | group),   data = mulsam.test$data,   coords = mulsam.test$coords,   bw = 10 ) summary(mod_Ftest) #> Hierarchical and geographically weighted regression model #> ========================================================= #> Formula: y ~ L(g1 + g2) + x1 + (z1 | group) #>  Method: Back-fitting and Maximum likelihood #>    Data: mulsam.test$data #>  #> Parameter Estimates #> ------------------- #> Fixed effects: #>             Estimated   Sd. Err      t.val  Pr(>|t|)       #>  Intercept   1.852190  0.203079   9.120541  0.000000  ***  #>         x1   1.967644  0.033827  58.168539  0.000000  ***  #>  #> Bandwidth: 10 (nearest neighbours) #>  #> GLSW effects: #>             Mean Est.  Mean Sd.   ***    **     *      .  #>  Intercept  -0.208441  0.247059  0.0%  0.0%  4.0%  24.0%  #>         g1   1.631474  1.795246  0.0%  0.0%  0.0%   0.0%  #>         g2   1.430116  1.476570  0.0%  0.0%  0.0%   0.0%  #>  #> SLR effects: #>    Groups       Name      Mean  Std.Dev.      Corr  #>     group  Intercept  0.000000  1.033171            #>                   z1  1.869539  1.033171  0.000000  #>  Residual             0.079964  1.033171            #>  #>  #> Diagnostics #> ----------- #>  rsquared  0.905207  #>    logLik       NaN  #>       AIC       NaN  #>  #> Scaled Residuals #> ---------------- #>        Min         1Q    Median        3Q       Max  #>  -3.416380  -0.584726  0.092501  0.725766  3.028003  #>  #> Other Information #> ----------------- #> Number of Obs: 873 #>        Groups: group , 25"},{"path":"/reference/hgwrr-package.html","id":null,"dir":"Reference","previous_headings":"","what":"HGWR: Hierarchical and Geographically Weighted Regression — hgwrr-package","title":"HGWR: Hierarchical and Geographically Weighted Regression — hgwrr-package","text":"R C++ implementation Hierarchical Geographically Weighted Regression (HGWR) model provided package. model divides coefficients three types: local fixed effects, global fixed effects, random effects. data spatial hierarchical structures (especially overlapping locations), worth trying model reach better fitness.","code":""},{"path":"/reference/hgwrr-package.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"HGWR: Hierarchical and Geographically Weighted Regression — hgwrr-package","text":"package yet installed build time.","code":""},{"path":"/reference/hgwrr-package.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"HGWR: Hierarchical and Geographically Weighted Regression — hgwrr-package","text":"Acknowledgement: gratefully acknowledge support China Scholarship Council.","code":""},{"path":"/reference/hgwrr-package.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"HGWR: Hierarchical and Geographically Weighted Regression — hgwrr-package","text":"Hu, Y., Lu, B., Ge, Y., Dong, G., 2022. Uncovering spatial heterogeneity real estate prices via combined hierarchical linear model geographically weighted regression. Environment Planning B: Urban Analytics City Science. doi:10.1177/23998083211063885","code":""},{"path":"/reference/hgwrr-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"HGWR: Hierarchical and Geographically Weighted Regression — hgwrr-package","text":"Yigong Hu, Richard Harris, Richard Timmerman","code":""},{"path":"/reference/logLik.hgwrm.html","id":null,"dir":"Reference","previous_headings":"","what":"Log likelihood function — logLik.hgwrm","title":"Log likelihood function — logLik.hgwrm","text":"Log likelihood function","code":""},{"path":"/reference/logLik.hgwrm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Log likelihood function — logLik.hgwrm","text":"","code":"# S3 method for class 'hgwrm' logLik(object, ...)"},{"path":"/reference/logLik.hgwrm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Log likelihood function — logLik.hgwrm","text":"object hgwrm object. ... Additional arguments.","code":""},{"path":"/reference/logLik.hgwrm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Log likelihood function — logLik.hgwrm","text":"logLik instance used S3 method logLik().","code":""},{"path":"/reference/make_dummy.html","id":null,"dir":"Reference","previous_headings":"","what":"Make Dummy Variables — make_dummy","title":"Make Dummy Variables — make_dummy","text":"Function make_dummy converts categorical variables data frame dummy variables. Function make_dummy_extract converts column dummy variables necessary assign appropriate names. See \"detail\" section information. Users can define functions allow model deal types variables properly.","code":""},{"path":"/reference/make_dummy.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Make Dummy Variables — make_dummy","text":"","code":"make_dummy(data)  make_dummy_extract(col, name)  # S3 method for class 'character' make_dummy_extract(col, name)  # S3 method for class 'factor' make_dummy_extract(col, name)  # S3 method for class 'logical' make_dummy_extract(col, name)  # Default S3 method make_dummy_extract(col, name)"},{"path":"/reference/make_dummy.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Make Dummy Variables — make_dummy","text":"data data frame dummy variables need extracted. col vector extract dummy variables. name vector's name.","code":""},{"path":"/reference/make_dummy.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Make Dummy Variables — make_dummy","text":"data frame extracted dummy variables.","code":""},{"path":"/reference/make_dummy.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Make Dummy Variables — make_dummy","text":"col character vector, function get unique values elements leave last one. , unique values combined name argument names new columns. col factor vector, function get levels leave last one. , level labels combined name argument names new columns. col logical vector, function convert numeric vector value TRUE mapped 1 FALSE 0. col types, default behaviour extracting dummy variables just copy original value try convert numeric values.","code":""},{"path":"/reference/make_dummy.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Make Dummy Variables — make_dummy","text":"","code":"make_dummy(iris[\"Species\"]) #>     Species.setosa Species.versicolor #> 1                1                  0 #> 2                1                  0 #> 3                1                  0 #> 4                1                  0 #> 5                1                  0 #> 6                1                  0 #> 7                1                  0 #> 8                1                  0 #> 9                1                  0 #> 10               1                  0 #> 11               1                  0 #> 12               1                  0 #> 13               1                  0 #> 14               1                  0 #> 15               1                  0 #> 16               1                  0 #> 17               1                  0 #> 18               1                  0 #> 19               1                  0 #> 20               1                  0 #> 21               1                  0 #> 22               1                  0 #> 23               1                  0 #> 24               1                  0 #> 25               1                  0 #> 26               1                  0 #> 27               1                  0 #> 28               1                  0 #> 29               1                  0 #> 30               1                  0 #> 31               1                  0 #> 32               1                  0 #> 33               1                  0 #> 34               1                  0 #> 35               1                  0 #> 36               1                  0 #> 37               1                  0 #> 38               1                  0 #> 39               1                  0 #> 40               1                  0 #> 41               1                  0 #> 42               1                  0 #> 43               1                  0 #> 44               1                  0 #> 45               1                  0 #> 46               1                  0 #> 47               1                  0 #> 48               1                  0 #> 49               1                  0 #> 50               1                  0 #> 51               0                  1 #> 52               0                  1 #> 53               0                  1 #> 54               0                  1 #> 55               0                  1 #> 56               0                  1 #> 57               0                  1 #> 58               0                  1 #> 59               0                  1 #> 60               0                  1 #> 61               0                  1 #> 62               0                  1 #> 63               0                  1 #> 64               0                  1 #> 65               0                  1 #> 66               0                  1 #> 67               0                  1 #> 68               0                  1 #> 69               0                  1 #> 70               0                  1 #> 71               0                  1 #> 72               0                  1 #> 73               0                  1 #> 74               0                  1 #> 75               0                  1 #> 76               0                  1 #> 77               0                  1 #> 78               0                  1 #> 79               0                  1 #> 80               0                  1 #> 81               0                  1 #> 82               0                  1 #> 83               0                  1 #> 84               0                  1 #> 85               0                  1 #> 86               0                  1 #> 87               0                  1 #> 88               0                  1 #> 89               0                  1 #> 90               0                  1 #> 91               0                  1 #> 92               0                  1 #> 93               0                  1 #> 94               0                  1 #> 95               0                  1 #> 96               0                  1 #> 97               0                  1 #> 98               0                  1 #> 99               0                  1 #> 100              0                  1 #> 101              0                  0 #> 102              0                  0 #> 103              0                  0 #> 104              0                  0 #> 105              0                  0 #> 106              0                  0 #> 107              0                  0 #> 108              0                  0 #> 109              0                  0 #> 110              0                  0 #> 111              0                  0 #> 112              0                  0 #> 113              0                  0 #> 114              0                  0 #> 115              0                  0 #> 116              0                  0 #> 117              0                  0 #> 118              0                  0 #> 119              0                  0 #> 120              0                  0 #> 121              0                  0 #> 122              0                  0 #> 123              0                  0 #> 124              0                  0 #> 125              0                  0 #> 126              0                  0 #> 127              0                  0 #> 128              0                  0 #> 129              0                  0 #> 130              0                  0 #> 131              0                  0 #> 132              0                  0 #> 133              0                  0 #> 134              0                  0 #> 135              0                  0 #> 136              0                  0 #> 137              0                  0 #> 138              0                  0 #> 139              0                  0 #> 140              0                  0 #> 141              0                  0 #> 142              0                  0 #> 143              0                  0 #> 144              0                  0 #> 145              0                  0 #> 146              0                  0 #> 147              0                  0 #> 148              0                  0 #> 149              0                  0 #> 150              0                  0  make_dummy_extract(iris$Species, \"Species\") #>     Species.setosa Species.versicolor #> 1                1                  0 #> 2                1                  0 #> 3                1                  0 #> 4                1                  0 #> 5                1                  0 #> 6                1                  0 #> 7                1                  0 #> 8                1                  0 #> 9                1                  0 #> 10               1                  0 #> 11               1                  0 #> 12               1                  0 #> 13               1                  0 #> 14               1                  0 #> 15               1                  0 #> 16               1                  0 #> 17               1                  0 #> 18               1                  0 #> 19               1                  0 #> 20               1                  0 #> 21               1                  0 #> 22               1                  0 #> 23               1                  0 #> 24               1                  0 #> 25               1                  0 #> 26               1                  0 #> 27               1                  0 #> 28               1                  0 #> 29               1                  0 #> 30               1                  0 #> 31               1                  0 #> 32               1                  0 #> 33               1                  0 #> 34               1                  0 #> 35               1                  0 #> 36               1                  0 #> 37               1                  0 #> 38               1                  0 #> 39               1                  0 #> 40               1                  0 #> 41               1                  0 #> 42               1                  0 #> 43               1                  0 #> 44               1                  0 #> 45               1                  0 #> 46               1                  0 #> 47               1                  0 #> 48               1                  0 #> 49               1                  0 #> 50               1                  0 #> 51               0                  1 #> 52               0                  1 #> 53               0                  1 #> 54               0                  1 #> 55               0                  1 #> 56               0                  1 #> 57               0                  1 #> 58               0                  1 #> 59               0                  1 #> 60               0                  1 #> 61               0                  1 #> 62               0                  1 #> 63               0                  1 #> 64               0                  1 #> 65               0                  1 #> 66               0                  1 #> 67               0                  1 #> 68               0                  1 #> 69               0                  1 #> 70               0                  1 #> 71               0                  1 #> 72               0                  1 #> 73               0                  1 #> 74               0                  1 #> 75               0                  1 #> 76               0                  1 #> 77               0                  1 #> 78               0                  1 #> 79               0                  1 #> 80               0                  1 #> 81               0                  1 #> 82               0                  1 #> 83               0                  1 #> 84               0                  1 #> 85               0                  1 #> 86               0                  1 #> 87               0                  1 #> 88               0                  1 #> 89               0                  1 #> 90               0                  1 #> 91               0                  1 #> 92               0                  1 #> 93               0                  1 #> 94               0                  1 #> 95               0                  1 #> 96               0                  1 #> 97               0                  1 #> 98               0                  1 #> 99               0                  1 #> 100              0                  1 #> 101              0                  0 #> 102              0                  0 #> 103              0                  0 #> 104              0                  0 #> 105              0                  0 #> 106              0                  0 #> 107              0                  0 #> 108              0                  0 #> 109              0                  0 #> 110              0                  0 #> 111              0                  0 #> 112              0                  0 #> 113              0                  0 #> 114              0                  0 #> 115              0                  0 #> 116              0                  0 #> 117              0                  0 #> 118              0                  0 #> 119              0                  0 #> 120              0                  0 #> 121              0                  0 #> 122              0                  0 #> 123              0                  0 #> 124              0                  0 #> 125              0                  0 #> 126              0                  0 #> 127              0                  0 #> 128              0                  0 #> 129              0                  0 #> 130              0                  0 #> 131              0                  0 #> 132              0                  0 #> 133              0                  0 #> 134              0                  0 #> 135              0                  0 #> 136              0                  0 #> 137              0                  0 #> 138              0                  0 #> 139              0                  0 #> 140              0                  0 #> 141              0                  0 #> 142              0                  0 #> 143              0                  0 #> 144              0                  0 #> 145              0                  0 #> 146              0                  0 #> 147              0                  0 #> 148              0                  0 #> 149              0                  0 #> 150              0                  0  make_dummy_extract(c(\"top\", \"mid\", \"low\", \"mid\", \"top\"), \"level\") #>   level.top level.mid #> 1         1         0 #> 2         0         1 #> 3         0         0 #> 4         0         1 #> 5         1         0  make_dummy_extract(factor(c(\"far\", \"near\", \"near\")), \"distance\") #>   distance.far #> 1            1 #> 2            0 #> 3            0  make_dummy_extract(c(TRUE, TRUE, FALSE), \"sold\") #>   sold #> 1    1 #> 2    1 #> 3    0"},{"path":"/reference/mulsam.test.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulated Spatial Multisampling Data For Test (DataFrame) — mulsam.test","title":"Simulated Spatial Multisampling Data For Test (DataFrame) — mulsam.test","text":"simulation data set testing use spatial hierarchical structure samples overlapping certain locations.","code":""},{"path":"/reference/mulsam.test.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulated Spatial Multisampling Data For Test (DataFrame) — mulsam.test","text":"","code":"data(mulsam.test)"},{"path":"/reference/mulsam.test.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Simulated Spatial Multisampling Data For Test (DataFrame) — mulsam.test","text":"list three items called \"data\", \"coords\" \"beta\". Item \"data\" data frame 873 observations 25 locations following 6 variables. y numeric vector, dependent variable \\(y\\) g1 numeric vector, group level independent variable \\(g_1\\) g2 numeric vector, group level independent variable \\(g_2\\) z1 numeric vector, sample level independent variable \\(z_1\\) x1 numeric vector, sample level independent variable \\(x_1\\) group numeric vector, group id sample g1 g2 used estimate local fixed effects; x1 used estimate global fixed effects z1 used estimate random effects.","code":""},{"path":"/reference/mulsam.test.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Simulated Spatial Multisampling Data For Test (DataFrame) — mulsam.test","text":"Yigong Hu yigong.hu@bristol.ac.uk","code":""},{"path":"/reference/mulsam.test.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulated Spatial Multisampling Data For Test (DataFrame) — mulsam.test","text":"","code":"data(mulsam.test) hgwr(formula = y ~ L(g1 + g2) + x1 + (z1 | group),      data = mulsam.test$data,      coords = mulsam.test$coords,      bw = 10, kernel = \"bisquared\") #> Hierarchical and geographically weighted regression model #> ========================================================= #> Formula: y ~ L(g1 + g2) + x1 + (z1 | group) #>  Method: Back-fitting and Maximum likelihood #>    Data: mulsam.test$data #>  #> Fixed Effects #> ------------- #>  Intercept        x1  #>   1.780635  1.967851  #>  #> Group-level Spatially Weighted Effects #> -------------------------------------- #> Bandwidth: 10 (nearest neighbours) #>  #> Coefficient estimates: #>  Coefficient        Min  1st Quartile     Median  3rd Quartile       Max  #>    Intercept  -0.796101     -0.612570  -0.267630      0.301641  0.754773  #>           g1  -0.084653      1.534803   1.711127      2.694849  6.206580  #>           g2   0.687552      0.871403   1.827057      2.353679  4.074047  #>  #> Sample-level Random Effects #> --------------------------- #>    Groups       Name  Std.Dev.      Corr  #>     group  Intercept  1.030520            #>                   z1  1.030520  0.000000  #>  Residual             1.030520            #>  #> Other Information #> ----------------- #> Number of Obs: 873 #>        Groups: group , 25"},{"path":"/reference/multisampling.html","id":null,"dir":"Reference","previous_headings":"","what":"Large Scale Simulated Spatial Multisampling Data (DataFrame) — multisampling","title":"Large Scale Simulated Spatial Multisampling Data (DataFrame) — multisampling","text":"simulation data spatial hierarchical structure samples overlapping certain locations.","code":""},{"path":"/reference/multisampling.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Large Scale Simulated Spatial Multisampling Data (DataFrame) — multisampling","text":"","code":"data(multisampling)"},{"path":"/reference/multisampling.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Large Scale Simulated Spatial Multisampling Data (DataFrame) — multisampling","text":"list three items called \"data\", \"coords\" \"beta\". Item \"data\" data frame 21434 observations 625 locations following 6 variables. y numeric vector, dependent variable \\(y\\) g1 numeric vector, group level independent variable \\(g_1\\) g2 numeric vector, group level independent variable \\(g_2\\) z1 numeric vector, sample level independent variable \\(z_1\\) x1 numeric vector, sample level independent variable \\(x_1\\) group numeric vector, group id sample g1 g2 used estimate local fixed effects; x1 used estimate global fixed effects z1 used estimate random effects.","code":""},{"path":"/reference/multisampling.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Large Scale Simulated Spatial Multisampling Data (DataFrame) — multisampling","text":"Yigong Hu yigong.hu@bristol.ac.uk","code":""},{"path":"/reference/multisampling.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Large Scale Simulated Spatial Multisampling Data (DataFrame) — multisampling","text":"","code":"if (FALSE) { # \\dontrun{ data(multisampling) hgwr(formula = y ~ L(g1 + g2) + x1 + (z1 | group),      data = multisampling$data,      coords = multisampling$coords,      bw = 32) } # }"},{"path":"/reference/print.hgwrm.html","id":null,"dir":"Reference","previous_headings":"","what":"Print description of a hgwrm object. — print.hgwrm","title":"Print description of a hgwrm object. — print.hgwrm","text":"Print description hgwrm object.","code":""},{"path":"/reference/print.hgwrm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print description of a hgwrm object. — print.hgwrm","text":"","code":"# S3 method for class 'hgwrm' print(x, decimal.fmt = \"%.6f\", ...)"},{"path":"/reference/print.hgwrm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print description of a hgwrm object. — print.hgwrm","text":"x hgwrm object returned hgwr(). decimal.fmt format string passing base::sprintf(). ... Arguments passed print_table_md col_sep Column separator. Default \"\". header_sep Header separator. Default \"-\". header_sep contains one character, repeated column. contains one character, printed first row. row_begin Character beginning row. Default col_sep. row_end Character ending row. Default col_sep. table_before Characters printed table. table_after Characters printed table. table_style Name pre-defined style. Possible values \"plain\", \"md\", \"latex\", \"booktabs\". Default \"plain\".","code":""},{"path":"/reference/print.hgwrm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print description of a hgwrm object. — print.hgwrm","text":"return.","code":""},{"path":[]},{"path":"/reference/print.hgwrm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Print description of a hgwrm object. — print.hgwrm","text":"","code":"data(mulsam.test) model <- hgwr(   formula = y ~ L(g1 + g2) + x1 + (z1 | group),   data = mulsam.test$data,   coords = mulsam.test$coords,   bw = 10 ) print(model) #> Hierarchical and geographically weighted regression model #> ========================================================= #> Formula: y ~ L(g1 + g2) + x1 + (z1 | group) #>  Method: Back-fitting and Maximum likelihood #>    Data: mulsam.test$data #>  #> Fixed Effects #> ------------- #>  Intercept        x1  #>   1.852190  1.967644  #>  #> Group-level Spatially Weighted Effects #> -------------------------------------- #> Bandwidth: 10 (nearest neighbours) #>  #> Coefficient estimates: #>  Coefficient        Min  1st Quartile     Median  3rd Quartile       Max  #>    Intercept  -0.549094     -0.439522  -0.151433     -0.024133  0.178044  #>           g1   0.909293      1.253143   1.692616      1.927313  2.310056  #>           g2   1.083410      1.279953   1.415744      1.594576  1.693768  #>  #> Sample-level Random Effects #> --------------------------- #>    Groups       Name  Std.Dev.      Corr  #>     group  Intercept  1.033171            #>                   z1  1.033171  0.000000  #>  Residual             1.033171            #>  #> Other Information #> ----------------- #> Number of Obs: 873 #>        Groups: group , 25 print(model, table.style = \"md\") #> Hierarchical and geographically weighted regression model #> ========================================================= #> Formula: y ~ L(g1 + g2) + x1 + (z1 | group) #>  Method: Back-fitting and Maximum likelihood #>    Data: mulsam.test$data #>  #> Fixed Effects #> ------------- #>  Intercept        x1  #>   1.852190  1.967644  #>  #> Group-level Spatially Weighted Effects #> -------------------------------------- #> Bandwidth: 10 (nearest neighbours) #>  #> Coefficient estimates: #>  Coefficient        Min  1st Quartile     Median  3rd Quartile       Max  #>    Intercept  -0.549094     -0.439522  -0.151433     -0.024133  0.178044  #>           g1   0.909293      1.253143   1.692616      1.927313  2.310056  #>           g2   1.083410      1.279953   1.415744      1.594576  1.693768  #>  #> Sample-level Random Effects #> --------------------------- #>    Groups       Name  Std.Dev.      Corr  #>     group  Intercept  1.033171            #>                   z1  1.033171  0.000000  #>  Residual             1.033171            #>  #> Other Information #> ----------------- #> Number of Obs: 873 #>        Groups: group , 25"},{"path":"/reference/print.spahetbootres.html","id":null,"dir":"Reference","previous_headings":"","what":"Print the result of spatial heterogeneity test — print.spahetbootres","title":"Print the result of spatial heterogeneity test — print.spahetbootres","text":"Print result spatial heterogeneity test","code":""},{"path":"/reference/print.spahetbootres.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print the result of spatial heterogeneity test — print.spahetbootres","text":"","code":"# S3 method for class 'spahetbootres' print(x, ...)"},{"path":"/reference/print.spahetbootres.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print the result of spatial heterogeneity test — print.spahetbootres","text":"x spahetbootres object. ... unused arguments.","code":""},{"path":"/reference/print.summary.hgwrm.html","id":null,"dir":"Reference","previous_headings":"","what":"Print summary of an hgwrm object. — print.summary.hgwrm","title":"Print summary of an hgwrm object. — print.summary.hgwrm","text":"Print summary hgwrm object.","code":""},{"path":"/reference/print.summary.hgwrm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print summary of an hgwrm object. — print.summary.hgwrm","text":"","code":"# S3 method for class 'summary.hgwrm' print(x, decimal.fmt = \"%.6f\", ...)"},{"path":"/reference/print.summary.hgwrm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print summary of an hgwrm object. — print.summary.hgwrm","text":"x object returned summary.hgwrm(). decimal.fmt format string passing base::sprintf(). ... Arguments passed print_table_md col_sep Column separator. Default \"\". header_sep Header separator. Default \"-\". header_sep contains one character, repeated column. contains one character, printed first row. row_begin Character beginning row. Default col_sep. row_end Character ending row. Default col_sep. table_before Characters printed table. table_after Characters printed table. table_style Name pre-defined style. Possible values \"plain\", \"md\", \"latex\", \"booktabs\". Default \"plain\".","code":""},{"path":"/reference/print.summary.hgwrm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print summary of an hgwrm object. — print.summary.hgwrm","text":"return.","code":""},{"path":[]},{"path":"/reference/print.summary.hgwrm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Print summary of an hgwrm object. — print.summary.hgwrm","text":"","code":"data(mulsam.test) model <- hgwr(   formula = y ~ L(g1 + g2) + x1 + (z1 | group),   data = mulsam.test$data,   coords = mulsam.test$coords,   bw = 10 ) summary(model) #> Hierarchical and geographically weighted regression model #> ========================================================= #> Formula: y ~ L(g1 + g2) + x1 + (z1 | group) #>  Method: Back-fitting and Maximum likelihood #>    Data: mulsam.test$data #>  #> Parameter Estimates #> ------------------- #> Fixed effects: #>             Estimated   Sd. Err      t.val  Pr(>|t|)       #>  Intercept   1.852190  0.203079   9.120541  0.000000  ***  #>         x1   1.967644  0.033827  58.168539  0.000000  ***  #>  #> Bandwidth: 10 (nearest neighbours) #>  #> GLSW effects: #>             Mean Est.  Mean Sd.   ***    **     *      .  #>  Intercept  -0.208441  0.247059  0.0%  0.0%  4.0%  24.0%  #>         g1   1.631474  1.795246  0.0%  0.0%  0.0%   0.0%  #>         g2   1.430116  1.476570  0.0%  0.0%  0.0%   0.0%  #>  #> SLR effects: #>    Groups       Name      Mean  Std.Dev.      Corr  #>     group  Intercept  0.000000  1.033171            #>                   z1  1.869539  1.033171  0.000000  #>  Residual             0.079964  1.033171            #>  #>  #> Diagnostics #> ----------- #>  rsquared  0.905207  #>    logLik       NaN  #>       AIC       NaN  #>  #> Scaled Residuals #> ---------------- #>        Min         1Q    Median        3Q       Max  #>  -3.416380  -0.584726  0.092501  0.725766  3.028003  #>  #> Other Information #> ----------------- #> Number of Obs: 873 #>        Groups: group , 25"},{"path":"/reference/print_table_md.html","id":null,"dir":"Reference","previous_headings":"","what":"Print a character matrix as a table. — print_table_md","title":"Print a character matrix as a table. — print_table_md","text":"Print character matrix table.","code":""},{"path":"/reference/print_table_md.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print a character matrix as a table. — print_table_md","text":"","code":"print_table_md(   x,   col_sep = \"\",   header_sep = \"\",   row_begin = \"\",   row_end = \"\",   table_before = NA_character_,   table_after = NA_character_,   table_style = c(\"plain\", \"md\", \"latex\", \"booktabs\"),   ... )"},{"path":"/reference/print_table_md.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print a character matrix as a table. — print_table_md","text":"x character matrix. col_sep Column separator. Default \"\". header_sep Header separator. Default \"-\". header_sep contains one character, repeated column. contains one character, printed first row. row_begin Character beginning row. Default col_sep. row_end Character ending row. Default col_sep. table_before Characters printed table. table_after Characters printed table. table_style Name pre-defined style. Possible values \"plain\", \"md\", \"latex\", \"booktabs\". Default \"plain\". ... Additional style control arguments.","code":""},{"path":"/reference/print_table_md.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print a character matrix as a table. — print_table_md","text":"return.","code":""},{"path":"/reference/print_table_md.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Print a character matrix as a table. — print_table_md","text":"table_style specified, col_sep, header_sep, row_begin row_end take effects. function automatically set values. possible value table_style, corresponding style settings shown following table. function, characters right padded spaces.","code":""},{"path":[]},{"path":"/reference/residuals.hgwrm.html","id":null,"dir":"Reference","previous_headings":"","what":"Get residuals. — residuals.hgwrm","title":"Get residuals. — residuals.hgwrm","text":"Get residuals.","code":""},{"path":"/reference/residuals.hgwrm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get residuals. — residuals.hgwrm","text":"","code":"# S3 method for class 'hgwrm' residuals(object, ...)"},{"path":"/reference/residuals.hgwrm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get residuals. — residuals.hgwrm","text":"object hgwrm object returned hgwr(). ... Parameter received functions.","code":""},{"path":"/reference/residuals.hgwrm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get residuals. — residuals.hgwrm","text":"vector consists residuals.","code":""},{"path":[]},{"path":"/reference/spatial_hetero_test.html","id":null,"dir":"Reference","previous_headings":"","what":"Generic method to test spatial heterogeneity — spatial_hetero_test","title":"Generic method to test spatial heterogeneity — spatial_hetero_test","text":"Generic method test spatial heterogeneity","code":""},{"path":"/reference/spatial_hetero_test.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generic method to test spatial heterogeneity — spatial_hetero_test","text":"","code":"spatial_hetero_test(x, ...)  # Default S3 method spatial_hetero_test(x, ...)  # S3 method for class 'matrix' spatial_hetero_test(x, coords, ...)  # S3 method for class 'numeric' spatial_hetero_test(x, coords, ...)  # S3 method for class 'vector' spatial_hetero_test(x, coords, ...)  # S3 method for class 'data.frame' spatial_hetero_test(x, coords, ...)  # S3 method for class 'sf' spatial_hetero_test(x, ...)"},{"path":"/reference/spatial_hetero_test.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generic method to test spatial heterogeneity — spatial_hetero_test","text":"x data tested. ... Arguments passed spatial_hetero_test_data, spatial_hetero_test_data resample total times resampling replacement. Default 5000. poly number polynomial terms used polynomial estimator. Default 2. bw adaptive bandwidth used polynomial estimator. Default 10. kernel kernel function used polynomial estimator. verbose verbosity level. Default 0. coords coordinates used testing. Accepts matrix vector. matrix, needs number rows x. vector, indicates columns x actual coordinates taken x.","code":""},{"path":"/reference/spatial_hetero_test.html","id":"methods-by-class-","dir":"Reference","previous_headings":"","what":"Methods (by class)","title":"Generic method to test spatial heterogeneity — spatial_hetero_test","text":"spatial_hetero_test(default): Default behavior. spatial_hetero_test(matrix): matrix, coords necessary. spatial_hetero_test(numeric): spatial_hetero_test(vector): spatial_hetero_test(data.frame): data frame, coords necessary. spatial_hetero_test(sf): sf object, coordinates centroids used. numerical columns tested.","code":""},{"path":"/reference/spatial_hetero_test_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Test the spatial heterogeneity in data based on permutation. — spatial_hetero_test_data","title":"Test the spatial heterogeneity in data based on permutation. — spatial_hetero_test_data","text":"Test spatial heterogeneity data based permutation.","code":""},{"path":"/reference/spatial_hetero_test_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Test the spatial heterogeneity in data based on permutation. — spatial_hetero_test_data","text":"","code":"spatial_hetero_test_data(   x,   coords,   ...,   resample = 5000,   poly = 2,   bw = 10,   kernel = c(\"bisquared\", \"gaussian\"),   verbose = 0 )"},{"path":"/reference/spatial_hetero_test_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Test the spatial heterogeneity in data based on permutation. — spatial_hetero_test_data","text":"x matrix data tested. column variable. coords matrix coordinates. ... Additional arguments. resample total times resampling replacement. Default 5000. poly number polynomial terms used polynomial estimator. Default 2. bw adaptive bandwidth used polynomial estimator. Default 10. kernel kernel function used polynomial estimator. verbose verbosity level. Default 0.","code":""},{"path":"/reference/spatial_hetero_test_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Test the spatial heterogeneity in data based on permutation. — spatial_hetero_test_data","text":"spahetbootres object permutation-test results following items: vars names variables. t0 value statistics original values. t value statistics permuted values. p p-value variable. Currently, variance used statistics.","code":""},{"path":"/reference/summary.hgwrm.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary an hgwrm object. — summary.hgwrm","title":"Summary an hgwrm object. — summary.hgwrm","text":"Summary hgwrm object.","code":""},{"path":"/reference/summary.hgwrm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary an hgwrm object. — summary.hgwrm","text":"","code":"# S3 method for class 'hgwrm' summary(object, ..., test_hetero = FALSE, verbose = 0)"},{"path":"/reference/summary.hgwrm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary an hgwrm object. — summary.hgwrm","text":"object hgwrm object returned hgwr(). ... arguments passed functions. test_hetero Logical/list value. Whether test spatial heterogeneity GLSW effects. set FALSE, test executed. set TRUE, test executed default parameters (see details ). accepts list enable test specified parameters. verbose Integer value control whether additional messages testing spatial heterogeneity reported.","code":""},{"path":"/reference/summary.hgwrm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summary an hgwrm object. — summary.hgwrm","text":"list containing summary informations hgwrm object following fields. diagnostic list diagnostic information. random.stddev standard deviation random effects. random.corr correlation matrix random effects. residuals residual vector.","code":""},{"path":"/reference/summary.hgwrm.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Summary an hgwrm object. — summary.hgwrm","text":"parameters used perform test spatial heterogeneity bw Bandwidth (unit: number nearest neighbours) used make spatial kernel density estimation. Default: 10. poly number polynomial terms used local polynomial estimation. Default: 2. resample Total resampling times. Default: 5000. kernel kernel function used local polynomial estimation. Options \"gaussian\" \"bisquared\". Default: \"bisquared\".","code":""},{"path":[]},{"path":"/reference/summary.hgwrm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summary an hgwrm object. — summary.hgwrm","text":"","code":"data(mulsam.test) m <- hgwr(   formula = y ~ L(g1 + g2) + x1 + (z1 | group),   data = mulsam.test$data,   coords = mulsam.test$coords,   bw = 10 ) summary(m) #> Hierarchical and geographically weighted regression model #> ========================================================= #> Formula: y ~ L(g1 + g2) + x1 + (z1 | group) #>  Method: Back-fitting and Maximum likelihood #>    Data: mulsam.test$data #>  #> Parameter Estimates #> ------------------- #> Fixed effects: #>             Estimated   Sd. Err      t.val  Pr(>|t|)       #>  Intercept   1.852190  0.203079   9.120541  0.000000  ***  #>         x1   1.967644  0.033827  58.168539  0.000000  ***  #>  #> Bandwidth: 10 (nearest neighbours) #>  #> GLSW effects: #>             Mean Est.  Mean Sd.   ***    **     *      .  #>  Intercept  -0.208441  0.247059  0.0%  0.0%  4.0%  24.0%  #>         g1   1.631474  1.795246  0.0%  0.0%  0.0%   0.0%  #>         g2   1.430116  1.476570  0.0%  0.0%  0.0%   0.0%  #>  #> SLR effects: #>    Groups       Name      Mean  Std.Dev.      Corr  #>     group  Intercept  0.000000  1.033171            #>                   z1  1.869539  1.033171  0.000000  #>  Residual             0.079964  1.033171            #>  #>  #> Diagnostics #> ----------- #>  rsquared  0.905207  #>    logLik       NaN  #>       AIC       NaN  #>  #> Scaled Residuals #> ---------------- #>        Min         1Q    Median        3Q       Max  #>  -3.416380  -0.584726  0.092501  0.725766  3.028003  #>  #> Other Information #> ----------------- #> Number of Obs: 873 #>        Groups: group , 25 summary(m, test_hetero = TRUE) #> Hierarchical and geographically weighted regression model #> ========================================================= #> Formula: y ~ L(g1 + g2) + x1 + (z1 | group) #>  Method: Back-fitting and Maximum likelihood #>    Data: mulsam.test$data #>  #> Parameter Estimates #> ------------------- #> Fixed effects: #>             Estimated   Sd. Err      t.val  Pr(>|t|)       #>  Intercept   1.852190  0.203079   9.120541  0.000000  ***  #>         x1   1.967644  0.033827  58.168539  0.000000  ***  #>  #> Bandwidth: 10 (nearest neighbours) #>  #> GLSW effects: #>             Mean Est.  Mean Sd.   ***    **     *      .  #>  Intercept  -0.208441  0.247059  0.0%  0.0%  4.0%  24.0%  #>         g1   1.631474  1.795246  0.0%  0.0%  0.0%   0.0%  #>         g2   1.430116  1.476570  0.0%  0.0%  0.0%   0.0%  #>  #> SLR effects: #>    Groups       Name      Mean  Std.Dev.      Corr  #>     group  Intercept  0.000000  1.033171            #>                   z1  1.869539  1.033171  0.000000  #>  Residual             0.079964  1.033171            #>  #>  #> Diagnostics #> ----------- #>  rsquared  0.905207  #>    logLik       NaN  #>       AIC       NaN  #>  #> Scaled Residuals #> ---------------- #>        Min         1Q    Median        3Q       Max  #>  -3.416380  -0.584726  0.092501  0.725766  3.028003  #>  #> Other Information #> ----------------- #> Number of Obs: 873 #>        Groups: group , 25 summary(m, test_hetero = list(kernel = \"gaussian\")) #> Hierarchical and geographically weighted regression model #> ========================================================= #> Formula: y ~ L(g1 + g2) + x1 + (z1 | group) #>  Method: Back-fitting and Maximum likelihood #>    Data: mulsam.test$data #>  #> Parameter Estimates #> ------------------- #> Fixed effects: #>             Estimated   Sd. Err      t.val  Pr(>|t|)       #>  Intercept   1.852190  0.203079   9.120541  0.000000  ***  #>         x1   1.967644  0.033827  58.168539  0.000000  ***  #>  #> Bandwidth: 10 (nearest neighbours) #>  #> GLSW effects: #>             Mean Est.  Mean Sd.   ***    **     *      .  #>  Intercept  -0.208441  0.247059  0.0%  0.0%  4.0%  24.0%  #>         g1   1.631474  1.795246  0.0%  0.0%  0.0%   0.0%  #>         g2   1.430116  1.476570  0.0%  0.0%  0.0%   0.0%  #>  #> SLR effects: #>    Groups       Name      Mean  Std.Dev.      Corr  #>     group  Intercept  0.000000  1.033171            #>                   z1  1.869539  1.033171  0.000000  #>  Residual             0.079964  1.033171            #>  #>  #> Diagnostics #> ----------- #>  rsquared  0.905207  #>    logLik       NaN  #>       AIC       NaN  #>  #> Scaled Residuals #> ---------------- #>        Min         1Q    Median        3Q       Max  #>  -3.416380  -0.584726  0.092501  0.725766  3.028003  #>  #> Other Information #> ----------------- #> Number of Obs: 873 #>        Groups: group , 25"},{"path":"/reference/wuhan.hp.html","id":null,"dir":"Reference","previous_headings":"","what":"Wuhan Second-hand House Price and POI Data (DataFrame) — wuhan.hp","title":"Wuhan Second-hand House Price and POI Data (DataFrame) — wuhan.hp","text":"data set second-hand house price Wuhan, China collected 2018.","code":""},{"path":"/reference/wuhan.hp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Wuhan Second-hand House Price and POI Data (DataFrame) — wuhan.hp","text":"","code":"data(multisampling)"},{"path":"/reference/wuhan.hp.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Wuhan Second-hand House Price and POI Data (DataFrame) — wuhan.hp","text":"list two items called \"data\" \"coords\". Item \"data\" data frame 13862 second-hand properties 779 neighbourhoods following 22 variables. Price House price per square metre. Floor.High 1 property high floor, otherwise 0. Floor.Low 1 property low floor, otherwise 0. Decoration.Fine 1 property well decorated, otherwise 0. PlateTower 1 property plate-tower type, otherwise 0. Steel 1 property 'steel' structure, otherwise 0. BuildingArea Building area square metres. Fee Management fee per square meter per month. d.Commercial Distance nearest commercial area. d.Greenland Distance nearest green land. d.Water Distance nearest river lake. d.University Distance nearest university. d.HighSchool Distance nearest high school. d.MiddleSchool Distance nearest middle school. d.PrimarySchool Distance nearest primary school. d.Kindergarten Distance nearest kindergarten. d.SubwayStation Distance nearest subway station. d.Supermarket Distance nearest supermarket. d.ShoppingMall Distance nearest shopping mall. lon Longitude coordinates (Projected CRS: EPSG 3857). lat Latitude coordinates (Projected CRS: EPSE 3857). group Group id sample. following variables group level: - Fee - d.Commercial - d.Greenland - d.Water - d.University - d.HighSchool - d.MiddleSchool - d.PrimarySchool - d.Kindergarten - d.SubwayStation - d.Supermarket - d.ShoppingMall following variables sample level: - Price - Floor.High - Floor.Low - Decoration.Fine - PlateTower - Steel - BuildingArea Item \"coords\" 779--2 matrix coordinates neighbourhoods.","code":""},{"path":"/reference/wuhan.hp.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Wuhan Second-hand House Price and POI Data (DataFrame) — wuhan.hp","text":"Yigong Hu yigong.hu@bristol.ac.uk","code":""},{"path":"/reference/wuhan.hp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Wuhan Second-hand House Price and POI Data (DataFrame) — wuhan.hp","text":"","code":"if (FALSE) { # \\dontrun{ data(wuhan.hp) hgwr(   formula = Price ~ L(d.Water + d.Commercial + d.PrimarySchool +             d.Kindergarten + Fee) + BuildingArea + (Floor.High | group),   data = wuhan.hp$data,   coords = wuhan.hp$coords, bw = 50, kernel = \"bisquared\") } # }"},{"path":"/news/index.html","id":"version-050","dir":"Changelog","previous_headings":"","what":"Version 0.5.0","title":"Version 0.5.0","text":"Feature: spatial_hetero_test() function testing spatial heterogeneity Feature: show progress bar testing spatial heterogeneity GLSW effects Feature: support Gaussian kernel function testing spatial heterogeneity Improve: efficiency testing spatial heterogeneity Fix: bandwidth optimisation issues Fix: output message summary hgwrm objects","code":""},{"path":"/news/index.html","id":"version-040","dir":"Changelog","previous_headings":"","what":"Version 0.4.0","title":"Version 0.4.0","text":"Feature: support use L() specify local fixed effects Feature: support sf objects Feature: enable set intercept Feature: report diagnostic information Update: wuhan.hp data","code":""},{"path":"/news/index.html","id":"version-030","dir":"Changelog","previous_headings":"","what":"Version 0.3.0","title":"Version 0.3.0","text":"Feature: bandwidth optimisation CV criterion Update: wuhan.hp data Fix: fill parameter cat function","code":""},{"path":"/news/index.html","id":"version-023","dir":"Changelog","previous_headings":"","what":"Version 0.2.3","title":"Version 0.2.3","text":"Feature: new data sets Fix: rename multisampling$coord coords Fix: data document errors Fix: error wuhan.hp data Fix: use group index instead original value Fix: don’t run examples large data set","code":""},{"path":"/news/index.html","id":"version-022","dir":"Changelog","previous_headings":"","what":"Version 0.2.2","title":"Version 0.2.2","text":"Fix: use gsl-config --libs configure script","code":""},{"path":"/news/index.html","id":"version-021","dir":"Changelog","previous_headings":"","what":"Version 0.2.1","title":"Version 0.2.1","text":"Fix: C++ compile errors Fix: first sentence description field Fix: error R function coef.hgwrm Fix: missing .Rd files","code":""},{"path":"/news/index.html","id":"version-020","dir":"Changelog","previous_headings":"","what":"Version 0.2.0","title":"Version 0.2.0","text":"Feature: R interface set kernel Fix: incompatible generic function definitions Fix: R check warnings","code":""},{"path":"/news/index.html","id":"version-010","dir":"Changelog","previous_headings":"","what":"Version 0.1.0","title":"Version 0.1.0","text":"Feature: R function hgwr","code":""}]
