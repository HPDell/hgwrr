[{"path":[]},{"path":"/articles/hgwrr.html","id":"model-calibration","dir":"Articles","previous_headings":"Usage","what":"Model calibration","title":"hgwrr","text":"calibrate HGWR model, use function hgwr(). following explaintion important parameters.","code":"hgwr(   formula, data, ..., bw = \"CV\",   kernel = c(\"gaussian\", \"bisquared\"),   alpha = 0.01, eps_iter = 1e-6, eps_gradient = 1e-6,   max_iters = 1e6, max_retries = 1e6,   ml_type = c(\"D_Only\", \"D_Beta\"), verbose = 0 )"},{"path":"/articles/hgwrr.html","id":"formula","dir":"Articles","previous_headings":"Usage > Model calibration","what":"formula","title":"hgwrr","text":"parameter specifies model form. Recall three kinds effects GLSW, fixed, SLR effects. specified different parts formula. formula, L() used mark effects GLSW effects, ( | group) used set SLR effects grouping indicator. group-level variables can GLSW effects.","code":"response ~ L(GLSW) + fixed + (SLR | group)"},{"path":"/articles/hgwrr.html","id":"data","dir":"Articles","previous_headings":"Usage > Model calibration","what":"data","title":"hgwrr","text":"sf objects version 0.3-1, parameter supports sf objects. case, arguments ... required. example. data.frame objects data normal data.frame object, extra argument coords required specify coordinates group. Note row order coords needs match group variable. example.","code":"data(wuhan.hp) m_sf <- hgwr(   formula = Price ~ L(d.PrimarySchool + d.ShoppingMall) + BuildingArea + (Floor.High | group),   data = wuhan.hp ) data(multisampling) m_df <- hgwr(   formula = y ~ L(g1 + g2) + x1 + (z1 | group),   data = multisampling$data,   coords = multisampling$coords )"},{"path":"/articles/hgwrr.html","id":"bw-and-kernel","dir":"Articles","previous_headings":"Usage > Model calibration","what":"bw and kernel","title":"hgwrr","text":"Argument bw bandwidth used estimate GLSW effects. can either following options: integer value representing number nearest neighbours. \"CV\" letting algorithm select one. Argument kernel kernel function used estimate GLSW effects. Currently, two choices: \"gaussian\" \"bisquared\".","code":""},{"path":"/articles/hgwrr.html","id":"results","dir":"Articles","previous_headings":"Usage","what":"Results","title":"hgwrr","text":"output returned object hgwr() shows estimates effects. summary() method shows diagnostic information. methods provided.","code":"m_sf #> Hierarchical and geographically weighted regression model #> ========================================================= #> Formula: Price ~ L(d.PrimarySchool + d.ShoppingMall) + BuildingArea +   #>     (Floor.High | group) #>  Method: Back-fitting and Maximum likelihood #>    Data: wuhan.hp #>  #> Global Fixed Effects #> ------------------- #>  Intercept  BuildingArea  #>  10.001432     -0.020691  #>  #> Local Fixed Effects #> ------------------- #> Bandwidth: 5 (nearest neighbours) #>      Coefficient        Min  1st Quartile     Median  3rd Quartile       Max  #>        Intercept  -5.001588     -0.602239  -0.126958      0.410095  3.996967  #>  d.PrimarySchool  -0.429613     -0.056204  -0.003844      0.064953  1.101605  #>   d.ShoppingMall  -0.869904     -0.077189  -0.023644      0.031606  0.929402  #>  #> Random Effects #> -------------- #>    Groups        Name  Std.Dev.      Corr  #>     group   Intercept  0.103542            #>            Floor.High  0.085536  0.075881  #>  Residual              0.081513            #>  #> Other Information #> ----------------- #> Number of Obs: 19599 #>        Groups: group , 776 summary(m_sf) #> Hierarchical and geographically weighted regression model #> ========================================================= #> Formula: Price ~ L(d.PrimarySchool + d.ShoppingMall) + BuildingArea +   #>     (Floor.High | group) #>  Method: Back-fitting and Maximum likelihood #>    Data: wuhan.hp #>  #> Diagnostics #> ----------- #>  Rsquared  #>  0.921381  #>  #> Scaled residuals #> ---------------- #>        Min         1Q     Median        3Q       Max  #>  -0.507865  -0.045573  -0.002432  0.041901  0.859673  #>  #> Other Information #> ----------------- #> Number of Obs: 19599 #>        Groups: group , 776 head(coef(m_sf)) #>   Intercept d.PrimarySchool d.ShoppingMall BuildingArea  Floor.High group #> 1  8.884834     -0.04424340   -0.077268083  -0.02069085 -0.03352510     1 #> 2  8.870427     -0.05093882   -0.118210808  -0.02069085  0.02936480     2 #> 3  9.166970     -0.05483916   -0.019135931  -0.02069085 -0.01001839     3 #> 4  9.375207     -0.04850985    0.004227169  -0.02069085  0.02493700     4 #> 5  8.836228     -0.04083049   -0.130147898  -0.02069085  0.01395447     5 #> 6  9.378261     -0.05746188    0.007812618  -0.02069085  0.07232532     6 head(fitted(m_sf)) #> [1] 9.517168 9.515041 9.517307 9.517246 9.527987 9.518763 head(residuals(m_sf)) #> [1] -0.05864031 -0.15930254 -0.08190522  0.05627794  0.12979187  0.14373532"},{"path":[]},{"path":"/articles/hgwrr.html","id":"model-comparison","dir":"Articles","previous_headings":"Further reading","what":"Model comparison","title":"hgwrr","text":"Article HGWR Model Use site compares HGWR GWR HLM simulation data. short paper compares HGWR, GWR, MGWR, HLM simulation data. codes shown site.","code":""},{"path":"/articles/hgwrr.html","id":"mathematical-basis","dir":"Articles","previous_headings":"Further reading","what":"Mathematical basis","title":"hgwrr","text":"following papers shows details mathematical basis HGWR model. Yigong Hu, Richard Harris, Richard Timmerman, Binbin Lu. Hierarchical Geographically Weighted Regression Model Backfitting Maximum Likelihood Estimator (Short Paper). 12th International Conference Geographic Information Science (GIScience 2023). Leibniz International Proceedings Informatics (LIPIcs), Volume 277, pp. 39:1-39:6, Schloss Dagstuhl – Leibniz-Zentrum für Informatik (2023) DOI Hu, Yigong, Lu, Binbin, Ge, Yong, Dong, Guanpeng, 2022. Uncovering spatial heterogeneity real estate prices via combined hierarchical linear model geographically weighted regression. Environment Planning B: Urban Analytics City Science. DOI","code":""},{"path":[]},{"path":"/articles/introduction.html","id":"what-is-hgwr-model","dir":"Articles","previous_headings":"Introduction to HGWR Model","what":"What is HGWR model?","title":"HGWR Model and How to Use It","text":"Hierarchical Geographically Weighted Regression, shorted HGWR, spatial modelling method designed data spatial hierarchical structures. Just name implies, combination Hierarchical Linear Model [HLM, also known Multilevel Model, @Raudenbush-1993] Geographically Weighted Regression [GWR, @BrunsdonFotheringham-1996]. model, spatial effects divided three types: global fixed, local fixed random. Formally, expressed \\[ y = G\\gamma + X\\beta + Z\\mu + \\epsilon \\] \\(y\\) dependent variable, \\(G\\) group level independent variables, \\(\\gamma\\) local fixed effects, \\(X\\) also group level independent variables, \\(\\beta\\) global fixed effects, \\(Z\\) individual level independent variables, \\(\\mu\\) random effects, \\(\\epsilon\\) individual errors.","code":""},{"path":"/articles/introduction.html","id":"why-hgwr-model","dir":"Articles","previous_headings":"Introduction to HGWR Model","what":"Why HGWR model?","title":"HGWR Model and How to Use It","text":"know, hierarchical structure commonly existing spatial data. example, cities can grouped provinces higher-level administrative district belong ; house prices may share factors block; students one school different access education resources another school. dealing type data, usually choose HLM address within-group homogeneity -group heterogeneity. usually two types variables: group-level variables sample-level variables. formal ones used describe properties groups (provinces, blocks schools); latter ones observations individual samples (cities, houses students). effect sample-level variables similar groups, thus modelled fixed coefficients (effects). others, modelled individually, .e., random effects. However, group-level variables, can modelled fixed effects. spatial data, encounter problems. According Tobler’s first law Geography “Everything related everything else, near things related distant things” [@Tobler-1970]. model calibrated equally weighted samples, spatial heterogeneity overlooked [@FotheringhamBrunsdon-2002]. Thus, requires us distinguish “local fixed effects” “global fixed effects” discover spatial heterogeneity group-level variables. GWR Multiscale GWR [@FotheringhamYang-2017, LuBrunsdon-2017] dealing data hierarchical structures, GWR problematic [@HuLu-2022]. know GWR calibrate model unique coefficients sample borrowing data neighbours. uses parameter “bandwidth” control many neighbours included. samples hierarchically structured, everything works well. However, just imagine situation like Figure 1. two samples red color blue color, take number neighbours, actually spatial extents . extreme cases, spatial extends samples small hold one two location, large enough. lead failure bandwidth optimization reduce reliability optimized bandwidth. solve problems mentioned , need use HGWR model. able modelling spatial hierarchical structure spatial heterogeneity simultaneously. Examples can show works well spatial hierarchical data.","code":""},{"path":"/articles/introduction.html","id":"modelling-with-hgwr-model","dir":"Articles","previous_headings":"","what":"Modelling with HGWR Model","title":"HGWR Model and How to Use It","text":"R package hgwrr built calibrating HGWR model. section, going show use .","code":""},{"path":"/articles/introduction.html","id":"installation","dir":"Articles","previous_headings":"Modelling with HGWR Model","what":"Installation","title":"HGWR Model and How to Use It","text":"Package hgwrr available CRAN. Simply type following codes install . download latest released source package run following command install package. Note RTools required Windows.","code":"install.packages(\"hgwrr\") R CMD INSTALL hgwrr_0.2-0.tar.gz"},{"path":"/articles/introduction.html","id":"usage","dir":"Articles","previous_headings":"Modelling with HGWR Model","what":"Usage","title":"HGWR Model and How to Use It","text":"going show usage hgwrr package simulated data. First, need load package R session. can calibrate HGWR model via hgwr() function. first five arguments mandatory. formula accepts formula object R. format follows lme4 package. two types effects: fixed effects random effects, use following format specify : data accepts data.frame sf object R. variables specified formula extracted data. (needed data type data.frame) coords accepts matrix 2 columns. row longitude latitude group. bw accepts integer numeric number specify bandwidth used geographically weighted process. Currently can adaptive bandwidth. arguments optional used control backfitting maximum likelihood algorithm. occassions default values fine. default values cause problems want change , please check documentation function hgwr() infomation.","code":"library(hgwrr) #> Loading required package: sf #> Linking to GEOS 3.10.2, GDAL 3.4.1, PROJ 8.2.1; sf_use_s2() is TRUE hgwr(   formula, data, coords, bw,   alpha = 0.01, eps_iter = 1e-06, eps_gradient = 1e-06, max_iters = 1e+06,   max_retries = 10, ml_type = HGWR_ML_TYPE_D_ONLY, verbose = 0 ) dependent ~ L(local.fixed) + fixed + (random | group)"},{"path":"/articles/introduction.html","id":"example-a-small-simulated-data-set","dir":"Articles","previous_headings":"Modelling with HGWR Model","what":"Example: A Small Simulated Data Set","title":"HGWR Model and How to Use It","text":"example used show usage package test whether works. don’t care good fitness model data set. data set “multisampling” provided package, y dependent variable, g1 g2 two group-level variables, z1 x1 two sample-level variables, group labels groups belong , U, V longitude latitude coordinate values groups. regards g1 g2 local fixed effects, x1 global fixed effects z1 random effects. can calibrate HGWR model like output model shows estimations global fixed effects, summary local fixed effects. Also standard deviations random effects correlation coefficients . can look coefficient estimations. ggplot2 packages, can create figures.  can also convert spatial data use tmap visualize.  can also fetch fitted residuals. summary() function give statistical information model. current stage, pesudo \\(R^2\\) available. future, diagnostic information provided package.","code":"data(multisampling) head(multisampling$data) #>           y        g1         g2         z1         x1 group #> 1 1.2311965 0.1706889 -0.2246718  1.4808437  0.7930132     1 #> 2 2.7154442 0.1706889 -0.2246718  0.4890035  0.5222513     1 #> 3 1.9980754 0.1706889 -0.2246718 -0.2261288  1.7462222     1 #> 4 3.7671728 0.1706889 -0.2246718  0.3268472 -1.2713361     1 #> 5 4.4938533 0.1706889 -0.2246718  1.8754945  2.1973895     1 #> 6 0.7256683 0.1706889 -0.2246718 -0.3023764  0.4331308     1 head(multisampling$coords) #>          U        V #> 1 2940.897 2851.943 #> 2 3002.659 3157.717 #> 3 2848.345 2904.326 #> 4 2863.735 2907.999 #> 5 3117.849 2800.236 #> 6 2906.585 2972.770 ms_hgwr <- hgwr(   formula = y ~ L(g1 + g2) + x1 + (z1 | group),   data = multisampling$data,   coords = multisampling$coords,   bw = 10 ) ms_hgwr #> Hierarchical and geographically weighted regression model #> ========================================================= #> Formula: y ~ L(g1 + g2) + x1 + (z1 | group) #>  Method: Back-fitting and Maximum likelihood #>    Data: multisampling$data #>  #> Global Fixed Effects #> ------------------- #>  Intercept        x1  #>   2.844509  0.966059  #>  #> Local Fixed Effects #> ------------------- #> Bandwidth: 10 (nearest neighbours) #>  Coefficient        Min  1st Quartile     Median  3rd Quartile        Max  #>    Intercept  -1.197344     -1.117052  -0.906456     -0.677988  -0.493596  #>           g1   5.969397      6.328338   7.136143      7.447083   8.481628  #>           g2  -0.683021      0.043467   0.887209      1.174541   1.521918  #>  #> Random Effects #> -------------- #>    Groups       Name  Std.Dev.      Corr  #>     group  Intercept  1.921255            #>                   z1  1.921255  0.000000  #>  Residual             1.921255            #>  #> Other Information #> ----------------- #> Number of Obs: 484 #>        Groups: group , 16 coef(ms_hgwr) #>    Intercept       g1          g2        x1          z1 group #> 1  0.8709247 7.718650  0.04654332 0.9660594 -0.19316953     1 #> 2  3.3999054 6.554636  1.33431861 0.9660594  0.28646830     2 #> 3  0.8304537 7.420539  0.79849908 0.9660594  1.27063639     3 #> 4  2.4940515 7.395640  0.86517318 0.9660594 -0.59984180     4 #> 5  5.9621920 8.481628 -0.68302067 0.9660594 -1.46606958     5 #> 6  0.5926539 6.235741  1.26283083 0.9660594  0.69526966     6 #> 7  2.6324153 7.650960 -0.02458224 0.9660594 -1.46161629     7 #> 8  3.2007075 7.274534 -0.09758977 0.9660594  0.32008996     8 #> 9  1.0336835 5.969397  0.95359748 0.9660594  0.60679673     9 #> 10 1.2721665 6.004158  1.52191830 0.9660594 -0.85534304    10 #> 11 1.1170536 6.997752  1.08577440 0.9660594  0.31273932    11 #> 12 0.4284034 7.473628  0.04039086 0.9660594 -0.41973900    12 #> 13 0.3190390 7.308281  0.90924577 0.9660594  1.57629379    13 #> 14 3.1444830 5.975806  1.10442026 0.9660594  0.01154764    14 #> 15 1.8158363 6.420936  1.24466257 0.9660594  0.04762966    15 #> 16 2.2918536 6.734675  0.26179176 0.9660594 -0.04494147    16 library(ggplot2) ms_hgwr_coef <- as.data.frame(cbind(multisampling$coords, coef(ms_hgwr))) ggplot(ms_hgwr_coef, aes(x = U, y = V)) +   geom_point(aes(color = g1)) +   coord_fixed() + theme_bw() library(sf) library(tmap) #> Breaking News: tmap 3.x is retiring. Please test v4, e.g. with #> remotes::install_github('r-tmap/tmap') ms_hgwr_coef_sf <- st_as_sf(ms_hgwr_coef,                             coords = names(multisampling$coords),                             crs = 27700) tm_shape(ms_hgwr_coef_sf) + tm_dots(col = c(\"g1\", \"g2\"), size = 0.5) #> Variable(s) \"g2\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette. head(data.frame(   real = multisampling$data$y,   fitted = fitted(ms_hgwr),   residuals = residuals(ms_hgwr) )) #>        real    fitted  residuals #> 1 1.2311965 2.6579997 -1.4268032 #> 2 2.7154442 2.5880209  0.1274234 #> 3 1.9980754 3.9085913 -1.9105159 #> 4 3.7671728 0.8866327  2.8805402 #> 5 4.4938533 3.9384761  0.5553772 #> 6 0.7256683 2.6547957 -1.9291274 summary(ms_hgwr) #> Hierarchical and geographically weighted regression model #> ========================================================= #> Formula: y ~ L(g1 + g2) + x1 + (z1 | group) #>  Method: Back-fitting and Maximum likelihood #>    Data: multisampling$data #>  #> Diagnostics #> ----------- #>  Rsquared  #>  0.647031  #>  #> Scaled residuals #> ---------------- #>        Min         1Q     Median        3Q       Max  #>  -5.456449  -1.215641  -0.072241  1.246953  5.329316  #>  #> Other Information #> ----------------- #> Number of Obs: 484 #>        Groups: group , 16"},{"path":"/articles/introduction.html","id":"example-large-scale-simulated-data","dir":"Articles","previous_headings":"Modelling with HGWR Model","what":"Example: Large Scale Simulated Data","title":"HGWR Model and How to Use It","text":"former example, 484 observations 16 groups. adequate enough get precises estimations. , going use large scale simulated data set show performance HGWR model. true value coefficients already known (stored variable msl_beta), closeness estimated true values appliable performance metric. data set provided . structure similar data multisampling. data, also regards g1 g2 two group-level variables, z1 x1 two sample-level variables, group labels groups belong , U, V longitude latitude coordinate values groups. calibrate HGWR model. data large (13862 observations), may take time get results.","code":"data(multisampling.large) head(multisampling.large$data) #>          y        g1        g2         x1         z1 group #> 1 2.090256 0.1933745 -0.057836  0.7930132  1.1432041     1 #> 2 3.456452 0.1933745 -0.057836  0.5222513  1.0198745     1 #> 3 2.876627 0.1933745 -0.057836  1.7462222 -0.7071740     1 #> 4 4.510162 0.1933745 -0.057836 -1.2713361  0.8431381     1 #> 5 5.583738 0.1933745 -0.057836  2.1973895 -0.1603318     1 #> 6 1.601511 0.1933745 -0.057836  0.4331308 -0.7634945     1 head(multisampling.large$coords) #>            V1       V2 #> [1,] 2940.897 2851.943 #> [2,] 3002.659 3157.717 #> [3,] 2848.345 2904.326 #> [4,] 2863.735 2907.999 #> [5,] 3117.849 2800.236 #> [6,] 2906.585 2972.770 msl_beta <- multisampling.large$beta head(msl_beta) #>   Intercept        g1        g2          z1 x1 #> 1 0.7114818 11.309720  3.336208 -0.13592452  1 #> 2 1.6523106 12.438025  4.972805 -0.04079697  1 #> 3 1.4783712  6.876733 -5.069080  1.01053901  1 #> 4 3.2734732  6.088872 -3.877653 -0.15826244  1 #> 5 3.8245206 21.341706  3.814638 -2.15663750  1 #> 6 0.4886921  1.243364 -2.469626  0.49864683  1 msl_hgwr <- hgwr(   formula = y ~ L(g1 + g2) + x1 + (z1 | group),   data = multisampling.large$data,   coords = multisampling.large$coords,   bw = 32, kernel = \"bisquared\" ) msl_hgwr #> Hierarchical and geographically weighted regression model #> ========================================================= #> Formula: y ~ L(g1 + g2) + x1 + (z1 | group) #>  Method: Back-fitting and Maximum likelihood #>    Data: multisampling.large$data #>  #> Global Fixed Effects #> ------------------- #>  Intercept        x1  #>   1.856041  1.010716  #>  #> Local Fixed Effects #> ------------------- #> Bandwidth: 32 (nearest neighbours) #>  Coefficient         Min  1st Quartile     Median  3rd Quartile        Max  #>    Intercept   -0.828407     -0.220352  -0.054384      0.107088   0.634193  #>           g1   -3.110748      0.390257   3.637581      6.433589  12.076704  #>           g2  -10.971950     -2.457583  -0.439274      1.977123   8.306397  #>  #> Random Effects #> -------------- #>    Groups       Name  Std.Dev.      Corr  #>     group  Intercept  1.989349            #>                   z1  1.989349  0.000000  #>  Residual             1.989349            #>  #> Other Information #> ----------------- #> Number of Obs: 13862 #>        Groups: group , 200"},{"path":"/articles/introduction.html","id":"fitness-assessment","dir":"Articles","previous_headings":"Modelling with HGWR Model > Example: Large Scale Simulated Data","what":"Fitness Assessment","title":"HGWR Model and How to Use It","text":"check estimations intercept, g1, g2 z1 via scatter plots.  addition scatter plots, root mean squared errors (RMSE) mean absolute errors estimations true values also useful assess fitting performance.","code":"library(dplyr) #>  #> Attaching package: 'dplyr' #> The following objects are masked from 'package:stats': #>  #>     filter, lag #> The following objects are masked from 'package:base': #>  #>     intersect, setdiff, setequal, union library(purrr) coef(msl_hgwr) %>%   select(Intercept, g1, g2, z1) %>%    list(label = names(.), Truth = msl_beta[names(.)], Estimated = .) %>%   pmap_df(data.frame) %>%   mutate(label = factor(label, levels = c(\"Intercept\", \"g1\", \"g2\", \"z1\"))) %>%   ggplot(aes(x = Truth, y = Estimated)) + geom_point() +     coord_fixed() + scale_y_continuous(limits = c(-25, 25)) +     facet_grid(cols = vars(label)) +     theme_bw() msl_hgwr_err <- coef(msl_hgwr) %>%   select(Intercept, g1, g2, z1, x1) %>% {     as.data.frame(rbind(       MAE = map2_dbl(msl_beta, ., ~ mean(abs(.x - .y))),       RMSE = map2_dbl(msl_beta, ., ~ sqrt(mean((.x - .y)^2)))     ))   } msl_hgwr_err #>      Intercept       g1       g2        z1         x1 #> MAE  0.3589281 2.367257 2.266689 0.2025208 0.01071645 #> RMSE 0.4906000 3.644679 2.976845 0.2576828 0.01071645"},{"path":"/articles/introduction.html","id":"comparison-of-hgwr-gwr-and-hlm","dir":"Articles","previous_headings":"Modelling with HGWR Model > Example: Large Scale Simulated Data","what":"Comparison of HGWR, GWR and HLM","title":"HGWR Model and How to Use It","text":"comparison, can also calibrate GWR model HLM model look fitting performance. GWR model can calibrated following codes. also HLM model calibrated following codes. bar plot helpful compare fitness three models.  Note figure limited scale y axis make bar x1 z1 obvious. actual numbers labelled bars. can say HGWR best fitness among three models. able give precise estimations local fixed effects. can estimate global fixed effects also random effects precisely HLM , precisely GWR .","code":"enable_parallel = Sys.info()['sysname'] != 'Darwin' parallel_method = ifelse(enable_parallel, \"omp\", FALSE) parallel_arg = ifelse(enable_parallel, 0, NA) ### GWR model library(GWmodel) #> Loading required package: robustbase #> Loading required package: sp #> Loading required package: Rcpp #> Welcome to GWmodel version 2.3-2. msl_gwr_data <- multisampling.large$data coordinates(msl_gwr_data) <- with(multisampling.large, coords[data$group, ]) ##### Get optimized bandwidth via golden minimization algorithm. msl_gwr_bw <- 265  # The bandiwdth is pre-optimised to save time. ##### Calibrate GWR model with optimized bandwidth. msl_gwr <- gwr.basic(   formula = y ~ g1 + g2 + x1 + z1,   data = msl_gwr_data,   bw = msl_gwr_bw,   adaptive = TRUE,   parallel.method = parallel_method,   parallel.arg = parallel_arg ) #### Get coefficient estimations. #### As samples in one group have equal estimations, #### we use mean value of each group to represent them. msl_gwr_coef <- cbind(msl_gwr$SDF@data, group = msl_gwr_data$group) %>%   select(Intercept, g1, g2, x1, z1, group) %>%   group_by(group) %>%   summarise_all(mean) ##### Calculate RMSE and MAE of estimations. msl_gwr_err <- msl_gwr_coef %>%   select(Intercept, g1, g2, z1, x1) %>% {     as.data.frame(rbind(       MAE = map2_dbl(msl_beta, ., ~ mean(abs(.x - .y))),       RMSE = map2_dbl(msl_beta, ., ~ sqrt(mean((.x - .y)^2)))     ))   } msl_gwr_err #>         Intercept           g1           g2        z1        x1 #> MAE  3.414899e+15 8.396317e+16 1.925287e+17 0.7135892 0.4244955 #> RMSE 4.168939e+16 1.006233e+18 2.338391e+18 2.7673018 2.6585412 library(lme4) #> Loading required package: Matrix msl_hlm <- lmer(   formula = y ~ g1 + g2 + x1 + (z1 | group),   data = multisampling.large$data ) msl_hlm_coef <- coef(msl_hlm)$group colnames(msl_hlm_coef)[which(colnames(msl_hlm_coef) == \"(Intercept)\")] <- \"Intercept\" msl_hlm_err <- msl_hlm_coef %>%   select(Intercept, g1, g2, z1, x1) %>% {     as.data.frame(rbind(       MAE = map2_dbl(msl_beta, ., ~ mean(abs(.x - .y))),       RMSE = map2_dbl(msl_beta, ., ~ sqrt(mean((.x - .y)^2)))     ))   } msl_hlm_err #>      Intercept       g1       g2        z1        x1 #> MAE  0.5403015 3.961721 3.183228 0.2036397 0.0102346 #> RMSE 0.8043435 5.423963 4.610203 0.2584218 0.0102346 list(HGWR = msl_hgwr_err, GWR = msl_gwr_err, HLM = msl_hlm_err) %>%   map2_dfr(., names(.), function(x, nx) {     map2_dfr(x, colnames(x), function(i, ni) {       data.frame(Coefficient = ni, Label = rownames(x), Value = i)     }) %>% cbind(Algorithm = nx, .)   }) %>%   ggplot(aes(x = Coefficient, y = Value, group = Algorithm, fill = Algorithm)) +     geom_col(position = \"dodge\") +     geom_text(aes(label = round(Value, 2), y = pmin(Value, 10), vjust = -0.2),               position = position_dodge(0.9)) +     facet_grid(rows = vars(Label)) +     scale_y_continuous(limits = c(0, 10), oob = scales::squish,                        expand = expansion(add = c(0.5, 1))) +     theme_bw()"},{"path":"/articles/introduction.html","id":"case-study-impact-factors-of-house-price-in-wuhan","dir":"Articles","previous_headings":"Modelling with HGWR Model","what":"Case Study: Impact Factors of House Price in Wuhan","title":"HGWR Model and How to Use It","text":"fitness HGWR demonstrated simulation data, thing applying collected data sets. going use case study show usage HGWR type data. data set provided wuhan.hp package.  data set, collected 2018, 19599 properties located 19599 communities. observation, fields house properties, locational neighbourhood variables. details, distances nearby educational resources (kindergartens, primary schools, middle schools, high schools, universities), commercial areas (business districts, shopping malls supermarkets), transportation facilities (metro stations bus stations), rivers, lakes, green lands. following figure shows distribution properties, table gives information available variables. variable selection process [@HuLu-2022] suggests us use following variables build HGWR model: Fee d.Water d.Commercial d.PrimarySchool d.Kindergarten BuildingArea Floor.High going append variable d.ShoppingMall usually concerned customers researchers. regards locational Fee local fixed effects, BuildingArea global fixed effects Floor.High random effects. can calibrate HGWR model following codes.","code":"data(wuhan.hp) plot(wuhan.hp[\"Price\"]) whhp_hgwr <- hgwr(   formula = Price ~ L(d.Water + d.Commercial + d.PrimarySchool + d.ShoppingMall +             d.Kindergarten + Fee) + BuildingArea + (Floor.High | group),   data = wuhan.hp,   bw = \"CV\",   kernel = \"bisquared\",   eps_gradient = 1e-16,   eps_iter = 1e-16 ) whhp_hgwr #> Hierarchical and geographically weighted regression model #> ========================================================= #> Formula: Price ~ L(d.Water + d.Commercial + d.PrimarySchool + d.ShoppingMall +   #>     d.Kindergarten + Fee) + BuildingArea + (Floor.High | group) #>  Method: Back-fitting and Maximum likelihood #>    Data: wuhan.hp #>  #> Global Fixed Effects #> ------------------- #>  Intercept  BuildingArea  #>  10.109551     -0.019457  #>  #> Local Fixed Effects #> ------------------- #> Bandwidth: 58 (nearest neighbours) #>      Coefficient         Min  1st Quartile     Median  3rd Quartile        Max  #>        Intercept   -4.770935     -0.531137  -0.174606      0.159667   1.644956  #>          d.Water  -27.415594     -7.161128  -1.664053      2.556966  14.148116  #>     d.Commercial  -46.174510     -6.385290  -2.525259      2.361443  83.804032  #>  d.PrimarySchool   -0.202219     -0.049100  -0.028325      0.002443   0.194497  #>   d.ShoppingMall   -0.173705     -0.038987  -0.010240      0.025241   0.090512  #>   d.Kindergarten   -0.940186     -0.030436   0.004826      0.016680   0.454879  #>              Fee    0.015209      0.103115   0.143253      0.185047   0.377923  #>  #> Random Effects #> -------------- #>    Groups        Name  Std.Dev.       Corr  #>     group   Intercept  0.090349             #>            Floor.High  0.080260  -0.027620  #>  Residual              0.081498             #>  #> Other Information #> ----------------- #> Number of Obs: 19599 #>        Groups: group , 776"},{"path":"/articles/introduction.html","id":"coefficient-visualization","dir":"Articles","previous_headings":"Modelling with HGWR Model > Case Study: Impact Factors of House Price in Wuhan","what":"Coefficient Visualization","title":"HGWR Model and How to Use It","text":"can also make maps visualize estimated coefficients. Boundary data Wuhan provided. GeoJSON format can loaded package rgdal. coefficients, can simply combine coordinates houses. coefficients, coordinates groups can one--one matched. visualize coefficients estimations basemap.  figure, can see BuildingArea regarded global fixed effects, samples one estimations. Floor.High regarded random effects, group unique estimation spatial relationship can seen. local fixed effects, estimations seems locally related. suggested first law geography. Besides, spatial heterogeneity also obvious estimations.","code":"wuhan <- sf::read_sf(\"https://raw.githubusercontent.com/hpdell/hgwr/docs/data/wuhan.geojson\") wuhan_hp_groups <- st_centroid(aggregate(wuhan.hp, by = list(wuhan.hp$group), mean)) wuhp_coef_sf <- cbind(coef(whhp_hgwr), st_coordinates(wuhan_hp_groups)) %>%   st_as_sf(coords = c(\"X\", \"Y\"), crs = 4547) wh_basemap <- tm_shape(wuhan) + tm_polygons(col = \"white\") with(whhp_hgwr$effects, c(local.fixed, random, global.fixed, \"Intercept\")) %>%   map(function(var) {     wh_basemap +       tm_shape(wuhp_coef_sf, is.master = T) +       tm_dots(col = var, size = 0.1, midpoint = 0,               palette = \"-RdBu\", legend.col.reverse = T)   }) %>%     tmap_arrange(ncol = 3)"},{"path":"/articles/introduction.html","id":"residual-analysis","dir":"Articles","previous_headings":"Modelling with HGWR Model > Case Study: Impact Factors of House Price in Wuhan","what":"Residual Analysis","title":"HGWR Model and How to Use It","text":"Via standard function residuals(), access residuals estimated model. can visualize combining summary statistics residuals coordinates. example, created map showing mean residual group together standard deviation.  can also convery global Moran test residuals find well estimated points. p-value Moran’s value, can find although suggested reject null hypothesis, global spatial autocorrelation weak take effects. Additionally, local Moran test also useful.  can seen residuals spatially clustered. showing spatial clusters locate near boundary study area.","code":"whhp_hgwr_res <- data.frame(   residuals = residuals(whhp_hgwr),   group = wuhan.hp$group ) %>%   group_by(group) %>%   summarise(res.abs.mean = mean(abs(residuals)),             res.sd = sd(residuals)) %>%   cbind(st_coordinates(wuhan_hp_groups)) %>%   st_as_sf(coords = c(\"X\", \"Y\"), crs = 4547) wh_basemap +   tm_shape(whhp_hgwr_res, is.master = T) +   tm_dots(col = \"res.abs.mean\", size = \"res.sd\", midpoint = 0,           palette = \"-RdBu\", legend.col.reverse = T) library(spdep) #> Loading required package: spData #> To access larger datasets in this package, install the spDataLarge #> package with: `install.packages('spDataLarge', #> repos='https://nowosad.github.io/drat/', type='source')` whhp_hgwr_res_listw <- st_coordinates(whhp_hgwr_res) %>%   knearneigh(k = 20) %>% knn2nb() %>% nb2listw() %>% listw2U() moran.test(whhp_hgwr_res$res.abs.mean, whhp_hgwr_res_listw) #>  #>  Moran I test under randomisation #>  #> data:  whhp_hgwr_res$res.abs.mean   #> weights: whhp_hgwr_res_listw     #>  #> Moran I statistic standard deviate = 6.4461, p-value = 5.737e-11 #> alternative hypothesis: greater #> sample estimates: #> Moran I statistic       Expectation          Variance  #>      0.0666080558     -0.0012903226      0.0001109484 whhp_hgwr_res_localmoran <- localmoran(whhp_hgwr_res$res.abs.mean, whhp_hgwr_res_listw) wh_basemap +   tm_shape(cbind(whhp_hgwr_res, whhp_hgwr_res_localmoran), is.master = T) +   tm_dots(col = \"Ii\", size = 0.2, palette = \"-RdBu\", style = \"quantile\",           midpoint = 0, title = \"Local Moran\") whhp_hgwr_res$res_c <- scale(whhp_hgwr_res$res.abs.mean, scale = F) whhp_hgwr_res$lmoran_c <- scale(whhp_hgwr_res_localmoran[,1], scale = F) whhp_hgwr_res$quadrant <- with(whhp_hgwr_res, {   quadrant <- integer(length(res_c))   quadrant[res_c < 0 & lmoran_c < 0] <- 1   quadrant[res_c < 0 & lmoran_c > 0] <- 2   quadrant[res_c > 0 & lmoran_c < 0] <- 3   quadrant[res_c > 0 & lmoran_c > 0] <- 4   quadrant[whhp_hgwr_res_localmoran[,5] > 0.1] <- 0   as.factor(quadrant) }) LISA_palette <- list(   \"Insignificant\" = \"green\", \"Low-Low\" = \"darkblue\", \"Low-High\" = \"blue\",   \"High-Low\" = \"red\", \"High-High\" = \"darkred\" ) tm_layout(aes.palette = \"cat\") +   wh_basemap +   tm_shape(whhp_hgwr_res, is.master = T) +   tm_dots(col = \"quadrant\", size = 0.2,           palette = as.vector(unlist(LISA_palette)),           labels = names(LISA_palette))"},{"path":[]},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Yigong Hu. Maintainer.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Hu Y, Harris R, Timmerman R (2024). hgwrr: Hierarchical Geographically Weighted Regression. R package version 0.3.1,  https://hpdell.github.io/hgwrr/, https://github.com/HPDell/hgwrr/.","code":"@Manual{,   title = {hgwrr: Hierarchical and Geographically Weighted Regression},   author = {Yigong Hu and Richard Harris and Richard Timmerman},   year = {2024},   note = {R package version 0.3.1,  https://hpdell.github.io/hgwrr/},   url = {https://github.com/HPDell/hgwrr/}, }"},{"path":"/index.html","id":"hgwrr","dir":"","previous_headings":"","what":"Hierarchical and Geographically Weighted Regression","title":"Hierarchical and Geographically Weighted Regression","text":"package provides R interfaces calibrate Hierarchical Geographically Weighted Regression (HGWR) model.","code":""},{"path":"/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Hierarchical and Geographically Weighted Regression","text":"package now CRAN. want install latest version GitHub, note packages relies submodule hpdell/hgwr. install_github() devtools package probably working. Instead, ’s better recursively clone package.","code":"install.packages(\"hgwrr\") git clone --recursive https://github.com/hpdell/hgwrr R CMD INSTALL hgwrr"},{"path":"/index.html","id":"basic-usage","dir":"","previous_headings":"","what":"Basic Usage","title":"Hierarchical and Geographically Weighted Regression","text":"quick example showing works. information, please read article. full example.","code":"library(hgwrr) data(multisampling) hgwr(   formula = y ~ L(g1 + g2) + x1 + (z1 | group),   data = multisampling$data,   coords = multisampling$coords,   bw = 10 )"},{"path":"/index.html","id":"reference","dir":"","previous_headings":"","what":"Reference","title":"Hierarchical and Geographically Weighted Regression","text":"Hu, Yigong, Lu, Binbin, Ge, Yong, Dong, Guanpeng, 2022. Uncovering spatial heterogeneity real estate prices via combined hierarchical linear model geographically weighted regression. Environment Planning B: Urban Analytics City Science. DOI Yigong Hu, Richard Harris, Richard Timmerman, Binbin Lu. Hierarchical Geographically Weighted Regression Model Backfitting Maximum Likelihood Estimator (Short Paper). 12th International Conference Geographic Information Science (GIScience 2023). Leibniz International Proceedings Informatics (LIPIcs), Volume 277, pp. 39:1-39:6, Schloss Dagstuhl – Leibniz-Zentrum für Informatik (2023) DOI","code":""},{"path":"/reference/coef.hgwrm.html","id":null,"dir":"Reference","previous_headings":"","what":"Get estimated coefficients. — coef.hgwrm","title":"Get estimated coefficients. — coef.hgwrm","text":"Get estimated coefficients.","code":""},{"path":"/reference/coef.hgwrm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get estimated coefficients. — coef.hgwrm","text":"","code":"# S3 method for hgwrm coef(object, ...)"},{"path":"/reference/coef.hgwrm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get estimated coefficients. — coef.hgwrm","text":"object hgwrm object returned hgwr(). ... Parameter received functions.","code":""},{"path":"/reference/coef.hgwrm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get estimated coefficients. — coef.hgwrm","text":"DataFrame object consists estimated coefficients.","code":""},{"path":[]},{"path":"/reference/fitted.hgwrm.html","id":null,"dir":"Reference","previous_headings":"","what":"Get fitted reponse. — fitted.hgwrm","title":"Get fitted reponse. — fitted.hgwrm","text":"Get fitted reponse.","code":""},{"path":"/reference/fitted.hgwrm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get fitted reponse. — fitted.hgwrm","text":"","code":"# S3 method for hgwrm fitted(object, ...)"},{"path":"/reference/fitted.hgwrm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get fitted reponse. — fitted.hgwrm","text":"object hgwrm object returned hgwr(). ... Parameter received functions.","code":""},{"path":"/reference/fitted.hgwrm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get fitted reponse. — fitted.hgwrm","text":"vector consists fitted response values.","code":""},{"path":[]},{"path":"/reference/hgwr.html","id":null,"dir":"Reference","previous_headings":"","what":"Hierarchical and Geographically Weighted Regression — hgwr","title":"Hierarchical and Geographically Weighted Regression — hgwr","text":"Hierarchical Linear Model (HLM) local fixed effects.","code":""},{"path":"/reference/hgwr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Hierarchical and Geographically Weighted Regression — hgwr","text":"","code":"hgwr(   formula,   data,   ...,   bw = \"CV\",   kernel = c(\"gaussian\", \"bisquared\"),   alpha = 0.01,   eps_iter = 1e-06,   eps_gradient = 1e-06,   max_iters = 1e+06,   max_retries = 1e+06,   ml_type = c(\"D_Only\", \"D_Beta\"),   verbose = 0 )  # S3 method for sf hgwr(   formula,   data,   ...,   bw = \"CV\",   kernel = c(\"gaussian\", \"bisquared\"),   alpha = 0.01,   eps_iter = 1e-06,   eps_gradient = 1e-06,   max_iters = 1e+06,   max_retries = 1e+06,   ml_type = c(\"D_Only\", \"D_Beta\"),   verbose = 0 )  # S3 method for data.frame hgwr(   formula,   data,   ...,   coords,   bw = \"CV\",   kernel = c(\"gaussian\", \"bisquared\"),   alpha = 0.01,   eps_iter = 1e-06,   eps_gradient = 1e-06,   max_iters = 1e+06,   max_retries = 1e+06,   ml_type = c(\"D_Only\", \"D_Beta\"),   verbose = 0 )  hgwr_fit(   formula,   data,   coords,   bw = \"CV\",   kernel = c(\"gaussian\", \"bisquared\"),   alpha = 0.01,   eps_iter = 1e-06,   eps_gradient = 1e-06,   max_iters = 1e+06,   max_retries = 1e+06,   ml_type = c(\"D_Only\", \"D_Beta\"),   verbose = 0 )"},{"path":"/reference/hgwr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Hierarchical and Geographically Weighted Regression — hgwr","text":"formula formula. structure similar lmer function lme4 package. Models can specified following form:   information, please see formula subsection details. data data. ... arguments specified type data. bw numeric value. value bandwidth \"CV\". stage function support adaptive bandwidth. unit must number nearest neighbours. \"CV\" specified, algorithm automatically select optimized bandwidth value. kernel character value. specify kernel function used GWR part. Possible values gaussian Gaussian kernel function \\(k(d)=\\exp\\left(-\\frac{d^2}{b^2}\\right)\\) bisquared Bi-squared kernel function. \\(d<b\\) \\(k(d)=\\left(1-\\frac{d^2}{b^2}\\right)^2\\) else \\(k(d)=0\\) alpha numeric value. size first trial step maximum likelihood algorithm. eps_iter numeric value. Terminate threshold back-fitting. eps_gradient numeric value. Terminate threshold maximum likelihood algorithm. max_iters integer value. maximum iteration. max_retries integer value. algorithm tends diverge, stops automatically trying max_retires times. ml_type integer value. Represent maximum likelihood algorithm used. Possible values : D_Only \\(D\\) specified maximum likelihood. D_Beta \\(D\\) \\(beta\\) specified maximum likelihood. verbose integer value. Determine log level. Possible values : 0 log printed. 1 logs back-fitting printed. 2 logs printed. coords 2-column matrix. consists coordinates group.","code":"response ~ L(local.fixed) + global.fixed + (random | group)"},{"path":"/reference/hgwr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Hierarchical and Geographically Weighted Regression — hgwr","text":"list describing model following fields. gamma Coefficients local fixed effects. beta Coefficients global fixed effects. mu Coefficients random effects. D Variance-covariance matrix random effects. sigma Variance errors. effects list including names effects. call Calling function. frame DataFrame object sent call. frame.parsed Variables extracted data. groups Unique group labels extracted data.","code":""},{"path":[]},{"path":"/reference/hgwr.html","id":"effect-specification-in-formula","dir":"Reference","previous_headings":"","what":"Effect Specification in Formula","title":"Hierarchical and Geographically Weighted Regression — hgwr","text":"HGWR model, three types effects specified formula argument: Local fixed effects Effects wrapped functional symbol L. Random effects Effects specified outside functional symbol L left symbol |. Global fixed effects effects example, following formula example function written   g1 g2 local fixed effects, x1 global fixed effects, z1 random effects grouped group indicator group. Note random effects can specified !","code":"y ~ L(g1 + g2) + x1 + (z1 | group)"},{"path":"/reference/hgwr.html","id":"functions","dir":"Reference","previous_headings":"","what":"Functions","title":"Hierarchical and Geographically Weighted Regression — hgwr","text":"hgwr_fit(): Fit HGWR mdoel","code":""},{"path":"/reference/hgwr.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Hierarchical and Geographically Weighted Regression — hgwr","text":"","code":"data(multisampling) hgwr(formula = y ~ L(g1 + g2) + x1 + (z1 | group),      data = multisampling$data,      coords = multisampling$coords,      bw = 10) #> Hierarchical and geographically weighted regression model #> ========================================================= #> Formula: y ~ L(g1 + g2) + x1 + (z1 | group) #>  Method: Back-fitting and Maximum likelihood #>    Data: multisampling$data #>  #> Global Fixed Effects #> ------------------- #>  Intercept        x1  #>   2.844509  0.966059  #>  #> Local Fixed Effects #> ------------------- #> Bandwidth: 10 (nearest neighbours) #>  Coefficient        Min  1st Quartile     Median  3rd Quartile        Max  #>    Intercept  -1.197344     -1.117052  -0.906456     -0.677988  -0.493596  #>           g1   5.969397      6.328338   7.136143      7.447083   8.481628  #>           g2  -0.683021      0.043467   0.887209      1.174541   1.521918  #>  #> Random Effects #> -------------- #>    Groups       Name  Std.Dev.      Corr  #>     group  Intercept  1.921255            #>                   z1  1.921255  0.000000  #>  Residual             1.921255            #>  #> Other Information #> ----------------- #> Number of Obs: 484 #>        Groups: group , 16"},{"path":"/reference/hgwrr-package.html","id":null,"dir":"Reference","previous_headings":"","what":"HGWR: Hierarchical and Geographically Weighted Regression — hgwrr-package","title":"HGWR: Hierarchical and Geographically Weighted Regression — hgwrr-package","text":"R C++ implementation Hierarchical Geographically Weighted Regression (HGWR) model provided package. model divides coefficients three types: local fixed effects, global fixed effects, random effects. data spatial hierarchical structures (especially overlapping locations), worth trying model reach better fitness.","code":""},{"path":"/reference/hgwrr-package.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"HGWR: Hierarchical and Geographically Weighted Regression — hgwrr-package","text":"package yet installed build time.","code":""},{"path":"/reference/hgwrr-package.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"HGWR: Hierarchical and Geographically Weighted Regression — hgwrr-package","text":"Acknowledgements: gratefully acknowledge support China Scholarship Council.","code":""},{"path":"/reference/hgwrr-package.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"HGWR: Hierarchical and Geographically Weighted Regression — hgwrr-package","text":"Hu, Y., Lu, B., Ge, Y., Dong, G., 2022. Uncovering spatial heterogeneity real estate prices via combined hierarchical linear model geographically weighted regression. Environment Planning B: Urban Analytics City Science. doi:10.1177/23998083211063885","code":""},{"path":"/reference/hgwrr-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"HGWR: Hierarchical and Geographically Weighted Regression — hgwrr-package","text":"Yigong Hu, Richard Harris, Richard Timmerman","code":""},{"path":"/reference/make.dummy.html","id":null,"dir":"Reference","previous_headings":"","what":"Make Dummy Variables — make.dummy","title":"Make Dummy Variables — make.dummy","text":"Function make.dummy converts categorical variables data frame dummy variables. Function make.dummy.extract converts column dummy variables necessary assign appropriate names. See \"detail\" section information. Users can define functions allow model deal types variables properly.","code":""},{"path":"/reference/make.dummy.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Make Dummy Variables — make.dummy","text":"","code":"make.dummy(data)  make.dummy.extract(col, name)  # S3 method for character make.dummy.extract(col, name)  # S3 method for factor make.dummy.extract(col, name)  # S3 method for logical make.dummy.extract(col, name)  # S3 method for default make.dummy.extract(col, name)"},{"path":"/reference/make.dummy.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Make Dummy Variables — make.dummy","text":"data data frame dummy variables need extracted. col vector extract dummy variables. name vector's name.","code":""},{"path":"/reference/make.dummy.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Make Dummy Variables — make.dummy","text":"data frame extracted dummy variables.","code":""},{"path":"/reference/make.dummy.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Make Dummy Variables — make.dummy","text":"col character vector, function get unique values elements leave last one. , unique values combined name argument names new columns. col factor vector, function get levels leave last one. , level labels combined name argument names new columns. col logical vector, function convert numeric vector value TRUE mapped 1 FALSE 0. col types, default behaviour extracting dummy variables just copy original value try convert numeric values.","code":""},{"path":"/reference/make.dummy.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Make Dummy Variables — make.dummy","text":"","code":"make.dummy(iris[\"Species\"]) #>     Species.setosa Species.versicolor #> 1                1                  0 #> 2                1                  0 #> 3                1                  0 #> 4                1                  0 #> 5                1                  0 #> 6                1                  0 #> 7                1                  0 #> 8                1                  0 #> 9                1                  0 #> 10               1                  0 #> 11               1                  0 #> 12               1                  0 #> 13               1                  0 #> 14               1                  0 #> 15               1                  0 #> 16               1                  0 #> 17               1                  0 #> 18               1                  0 #> 19               1                  0 #> 20               1                  0 #> 21               1                  0 #> 22               1                  0 #> 23               1                  0 #> 24               1                  0 #> 25               1                  0 #> 26               1                  0 #> 27               1                  0 #> 28               1                  0 #> 29               1                  0 #> 30               1                  0 #> 31               1                  0 #> 32               1                  0 #> 33               1                  0 #> 34               1                  0 #> 35               1                  0 #> 36               1                  0 #> 37               1                  0 #> 38               1                  0 #> 39               1                  0 #> 40               1                  0 #> 41               1                  0 #> 42               1                  0 #> 43               1                  0 #> 44               1                  0 #> 45               1                  0 #> 46               1                  0 #> 47               1                  0 #> 48               1                  0 #> 49               1                  0 #> 50               1                  0 #> 51               0                  1 #> 52               0                  1 #> 53               0                  1 #> 54               0                  1 #> 55               0                  1 #> 56               0                  1 #> 57               0                  1 #> 58               0                  1 #> 59               0                  1 #> 60               0                  1 #> 61               0                  1 #> 62               0                  1 #> 63               0                  1 #> 64               0                  1 #> 65               0                  1 #> 66               0                  1 #> 67               0                  1 #> 68               0                  1 #> 69               0                  1 #> 70               0                  1 #> 71               0                  1 #> 72               0                  1 #> 73               0                  1 #> 74               0                  1 #> 75               0                  1 #> 76               0                  1 #> 77               0                  1 #> 78               0                  1 #> 79               0                  1 #> 80               0                  1 #> 81               0                  1 #> 82               0                  1 #> 83               0                  1 #> 84               0                  1 #> 85               0                  1 #> 86               0                  1 #> 87               0                  1 #> 88               0                  1 #> 89               0                  1 #> 90               0                  1 #> 91               0                  1 #> 92               0                  1 #> 93               0                  1 #> 94               0                  1 #> 95               0                  1 #> 96               0                  1 #> 97               0                  1 #> 98               0                  1 #> 99               0                  1 #> 100              0                  1 #> 101              0                  0 #> 102              0                  0 #> 103              0                  0 #> 104              0                  0 #> 105              0                  0 #> 106              0                  0 #> 107              0                  0 #> 108              0                  0 #> 109              0                  0 #> 110              0                  0 #> 111              0                  0 #> 112              0                  0 #> 113              0                  0 #> 114              0                  0 #> 115              0                  0 #> 116              0                  0 #> 117              0                  0 #> 118              0                  0 #> 119              0                  0 #> 120              0                  0 #> 121              0                  0 #> 122              0                  0 #> 123              0                  0 #> 124              0                  0 #> 125              0                  0 #> 126              0                  0 #> 127              0                  0 #> 128              0                  0 #> 129              0                  0 #> 130              0                  0 #> 131              0                  0 #> 132              0                  0 #> 133              0                  0 #> 134              0                  0 #> 135              0                  0 #> 136              0                  0 #> 137              0                  0 #> 138              0                  0 #> 139              0                  0 #> 140              0                  0 #> 141              0                  0 #> 142              0                  0 #> 143              0                  0 #> 144              0                  0 #> 145              0                  0 #> 146              0                  0 #> 147              0                  0 #> 148              0                  0 #> 149              0                  0 #> 150              0                  0  make.dummy.extract(iris$Species, \"Species\") #>     Species.setosa Species.versicolor #> 1                1                  0 #> 2                1                  0 #> 3                1                  0 #> 4                1                  0 #> 5                1                  0 #> 6                1                  0 #> 7                1                  0 #> 8                1                  0 #> 9                1                  0 #> 10               1                  0 #> 11               1                  0 #> 12               1                  0 #> 13               1                  0 #> 14               1                  0 #> 15               1                  0 #> 16               1                  0 #> 17               1                  0 #> 18               1                  0 #> 19               1                  0 #> 20               1                  0 #> 21               1                  0 #> 22               1                  0 #> 23               1                  0 #> 24               1                  0 #> 25               1                  0 #> 26               1                  0 #> 27               1                  0 #> 28               1                  0 #> 29               1                  0 #> 30               1                  0 #> 31               1                  0 #> 32               1                  0 #> 33               1                  0 #> 34               1                  0 #> 35               1                  0 #> 36               1                  0 #> 37               1                  0 #> 38               1                  0 #> 39               1                  0 #> 40               1                  0 #> 41               1                  0 #> 42               1                  0 #> 43               1                  0 #> 44               1                  0 #> 45               1                  0 #> 46               1                  0 #> 47               1                  0 #> 48               1                  0 #> 49               1                  0 #> 50               1                  0 #> 51               0                  1 #> 52               0                  1 #> 53               0                  1 #> 54               0                  1 #> 55               0                  1 #> 56               0                  1 #> 57               0                  1 #> 58               0                  1 #> 59               0                  1 #> 60               0                  1 #> 61               0                  1 #> 62               0                  1 #> 63               0                  1 #> 64               0                  1 #> 65               0                  1 #> 66               0                  1 #> 67               0                  1 #> 68               0                  1 #> 69               0                  1 #> 70               0                  1 #> 71               0                  1 #> 72               0                  1 #> 73               0                  1 #> 74               0                  1 #> 75               0                  1 #> 76               0                  1 #> 77               0                  1 #> 78               0                  1 #> 79               0                  1 #> 80               0                  1 #> 81               0                  1 #> 82               0                  1 #> 83               0                  1 #> 84               0                  1 #> 85               0                  1 #> 86               0                  1 #> 87               0                  1 #> 88               0                  1 #> 89               0                  1 #> 90               0                  1 #> 91               0                  1 #> 92               0                  1 #> 93               0                  1 #> 94               0                  1 #> 95               0                  1 #> 96               0                  1 #> 97               0                  1 #> 98               0                  1 #> 99               0                  1 #> 100              0                  1 #> 101              0                  0 #> 102              0                  0 #> 103              0                  0 #> 104              0                  0 #> 105              0                  0 #> 106              0                  0 #> 107              0                  0 #> 108              0                  0 #> 109              0                  0 #> 110              0                  0 #> 111              0                  0 #> 112              0                  0 #> 113              0                  0 #> 114              0                  0 #> 115              0                  0 #> 116              0                  0 #> 117              0                  0 #> 118              0                  0 #> 119              0                  0 #> 120              0                  0 #> 121              0                  0 #> 122              0                  0 #> 123              0                  0 #> 124              0                  0 #> 125              0                  0 #> 126              0                  0 #> 127              0                  0 #> 128              0                  0 #> 129              0                  0 #> 130              0                  0 #> 131              0                  0 #> 132              0                  0 #> 133              0                  0 #> 134              0                  0 #> 135              0                  0 #> 136              0                  0 #> 137              0                  0 #> 138              0                  0 #> 139              0                  0 #> 140              0                  0 #> 141              0                  0 #> 142              0                  0 #> 143              0                  0 #> 144              0                  0 #> 145              0                  0 #> 146              0                  0 #> 147              0                  0 #> 148              0                  0 #> 149              0                  0 #> 150              0                  0  make.dummy.extract(c(\"top\", \"mid\", \"low\", \"mid\", \"top\"), \"level\") #>   level.top level.mid #> 1         1         0 #> 2         0         1 #> 3         0         0 #> 4         0         1 #> 5         1         0  make.dummy.extract(factor(c(\"far\", \"near\", \"near\")), \"distance\") #>   distance.far #> 1            1 #> 2            0 #> 3            0  make.dummy.extract(c(TRUE, TRUE, FALSE), \"sold\") #>   sold #> 1    1 #> 2    1 #> 3    0"},{"path":"/reference/matrix2char.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert a numeric matrix to character matrix according to a format string. — matrix2char","title":"Convert a numeric matrix to character matrix according to a format string. — matrix2char","text":"Convert numeric matrix character matrix according format string.","code":""},{"path":"/reference/matrix2char.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert a numeric matrix to character matrix according to a format string. — matrix2char","text":"","code":"matrix2char(m, fmt = \"%.6f\")"},{"path":"/reference/matrix2char.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert a numeric matrix to character matrix according to a format string. — matrix2char","text":"m numeric matrix. fmt Format string. Passing base::sprintf().","code":""},{"path":[]},{"path":"/reference/multisampling.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulated Spatial Multisampling Data (DataFrame) — multisampling","title":"Simulated Spatial Multisampling Data (DataFrame) — multisampling","text":"simulation data spatial hierarchical structure samples overlapping certain locations.","code":""},{"path":"/reference/multisampling.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulated Spatial Multisampling Data (DataFrame) — multisampling","text":"","code":"data(multisampling)"},{"path":"/reference/multisampling.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Simulated Spatial Multisampling Data (DataFrame) — multisampling","text":"list two items called \"data\" \"coord\". Item \"data\" data frame 484 observations 16 locations following 6 variables. y numeric vector, dependent variable \\(y\\) g1 numeric vector, group level independent variable \\(g_1\\) g2 numeric vector, group level independent variable \\(g_2\\) z1 numeric vector, sample level independent variable \\(z_1\\) x1 numeric vector, sample level independent variable \\(x_1\\) group numeric vector, group id sample g1 g2 used estimate local fixed effects; x1 used estimate global fixed effects z1 used estimate random effects.","code":""},{"path":"/reference/multisampling.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Simulated Spatial Multisampling Data (DataFrame) — multisampling","text":"Yigong Hu yigong.hu@bristol.ac.uk","code":""},{"path":"/reference/multisampling.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulated Spatial Multisampling Data (DataFrame) — multisampling","text":"","code":"data(multisampling) hgwr(formula = y ~ L(g1 + g2) + x1 + (z1 | group),      data = multisampling$data,      coords = multisampling$coords,      bw = 10) #> Hierarchical and geographically weighted regression model #> ========================================================= #> Formula: y ~ L(g1 + g2) + x1 + (z1 | group) #>  Method: Back-fitting and Maximum likelihood #>    Data: multisampling$data #>  #> Global Fixed Effects #> ------------------- #>  Intercept        x1  #>   2.844509  0.966059  #>  #> Local Fixed Effects #> ------------------- #> Bandwidth: 10 (nearest neighbours) #>  Coefficient        Min  1st Quartile     Median  3rd Quartile        Max  #>    Intercept  -1.197344     -1.117052  -0.906456     -0.677988  -0.493596  #>           g1   5.969397      6.328338   7.136143      7.447083   8.481628  #>           g2  -0.683021      0.043467   0.887209      1.174541   1.521918  #>  #> Random Effects #> -------------- #>    Groups       Name  Std.Dev.      Corr  #>     group  Intercept  1.921255            #>                   z1  1.921255  0.000000  #>  Residual             1.921255            #>  #> Other Information #> ----------------- #> Number of Obs: 484 #>        Groups: group , 16"},{"path":"/reference/multisampling.large.html","id":null,"dir":"Reference","previous_headings":"","what":"Large Scale Simulated Spatial Multisampling Data (DataFrame) — multisampling.large","title":"Large Scale Simulated Spatial Multisampling Data (DataFrame) — multisampling.large","text":"large scale simulation data spatial hierarchical structure samples overlapping certain locations.","code":""},{"path":"/reference/multisampling.large.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Large Scale Simulated Spatial Multisampling Data (DataFrame) — multisampling.large","text":"","code":"data(multisampling)"},{"path":"/reference/multisampling.large.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Large Scale Simulated Spatial Multisampling Data (DataFrame) — multisampling.large","text":"list three items called \"data\", \"coords\" \"beta\". Item \"data\" data frame 13862 observations 200 locations following 6 variables. y numeric vector, dependent variable \\(y\\) g1 numeric vector, group level independent variable \\(g_1\\) g2 numeric vector, group level independent variable \\(g_2\\) z1 numeric vector, sample level independent variable \\(z_1\\) x1 numeric vector, sample level independent variable \\(x_1\\) group numeric vector, group id sample g1 g2 used estimate local fixed effects; x1 used estimate global fixed effects z1 used estimate random effects.","code":""},{"path":"/reference/multisampling.large.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Large Scale Simulated Spatial Multisampling Data (DataFrame) — multisampling.large","text":"Yigong Hu yigong.hu@bristol.ac.uk","code":""},{"path":"/reference/multisampling.large.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Large Scale Simulated Spatial Multisampling Data (DataFrame) — multisampling.large","text":"","code":"if (FALSE) { data(multisampling.large) hgwr(formula = y ~ L(g1 + g2) + x1 + (z1 | group),      data = multisampling.large$data,      coords = multisampling.large$coords,      bw = 32, kernel = \"bisquared\") }"},{"path":"/reference/print.hgwrm.html","id":null,"dir":"Reference","previous_headings":"","what":"Print description of a hgwrm object. — print.hgwrm","title":"Print description of a hgwrm object. — print.hgwrm","text":"Print description hgwrm object.","code":""},{"path":"/reference/print.hgwrm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print description of a hgwrm object. — print.hgwrm","text":"","code":"# S3 method for hgwrm print(x, decimal.fmt = \"%.6f\", ...)"},{"path":"/reference/print.hgwrm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print description of a hgwrm object. — print.hgwrm","text":"x hgwrm object returned hgwr(). decimal.fmt format string passing base::sprintf(). ... Arguments passed print.table.md col.sep Column seperator. Default \"\". header.sep Header seperator. Default \"-\". row.begin Character beginning row. Default col.sep. row.end Character ending row. Default col.sep. table.style Name pre-defined style. Possible values \"plain\", \"md\" \"latex\". Default \"plain\".","code":""},{"path":"/reference/print.hgwrm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print description of a hgwrm object. — print.hgwrm","text":"return.","code":""},{"path":[]},{"path":"/reference/print.hgwrm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Print description of a hgwrm object. — print.hgwrm","text":"","code":"data(multisampling) model <- hgwr(formula = y ~ L(g1 + g2) + x1 + (z1 | group),               data = multisampling$data,               coords = multisampling$coords,               bw = 10) print(model) #> Hierarchical and geographically weighted regression model #> ========================================================= #> Formula: y ~ L(g1 + g2) + x1 + (z1 | group) #>  Method: Back-fitting and Maximum likelihood #>    Data: multisampling$data #>  #> Global Fixed Effects #> ------------------- #>  Intercept        x1  #>   2.844509  0.966059  #>  #> Local Fixed Effects #> ------------------- #> Bandwidth: 10 (nearest neighbours) #>  Coefficient        Min  1st Quartile     Median  3rd Quartile        Max  #>    Intercept  -1.197344     -1.117052  -0.906456     -0.677988  -0.493596  #>           g1   5.969397      6.328338   7.136143      7.447083   8.481628  #>           g2  -0.683021      0.043467   0.887209      1.174541   1.521918  #>  #> Random Effects #> -------------- #>    Groups       Name  Std.Dev.      Corr  #>     group  Intercept  1.921255            #>                   z1  1.921255  0.000000  #>  Residual             1.921255            #>  #> Other Information #> ----------------- #> Number of Obs: 484 #>        Groups: group , 16 print(model, table.style = \"md\") #> Hierarchical and geographically weighted regression model #> ========================================================= #> Formula: y ~ L(g1 + g2) + x1 + (z1 | group) #>  Method: Back-fitting and Maximum likelihood #>    Data: multisampling$data #>  #> Global Fixed Effects #> ------------------- #> | Intercept |       x1 | #> | --------- | -------- | #> |  2.844509 | 0.966059 | #>  #> Local Fixed Effects #> ------------------- #> Bandwidth: 10 (nearest neighbours) #> | Coefficient |       Min | 1st Quartile |    Median | 3rd Quartile |       Max | #> | ----------- | --------- | ------------ | --------- | ------------ | --------- | #> |   Intercept | -1.197344 |    -1.117052 | -0.906456 |    -0.677988 | -0.493596 | #> |          g1 |  5.969397 |     6.328338 |  7.136143 |     7.447083 |  8.481628 | #> |          g2 | -0.683021 |     0.043467 |  0.887209 |     1.174541 |  1.521918 | #>  #> Random Effects #> -------------- #> |   Groups |      Name | Std.Dev. |     Corr | #> | -------- | --------- | -------- | -------- | #> |    group | Intercept | 1.921255 |          | #> |          |        z1 | 1.921255 | 0.000000 | #> | Residual |           | 1.921255 |          | #>  #> Other Information #> ----------------- #> Number of Obs: 484 #>        Groups: group , 16"},{"path":"/reference/print.summary.hgwrm.html","id":null,"dir":"Reference","previous_headings":"","what":"Print summary of an hgwrm object. — print.summary.hgwrm","title":"Print summary of an hgwrm object. — print.summary.hgwrm","text":"Print summary hgwrm object.","code":""},{"path":"/reference/print.summary.hgwrm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print summary of an hgwrm object. — print.summary.hgwrm","text":"","code":"# S3 method for summary.hgwrm print(x, decimal.fmt = \"%.6f\", ...)"},{"path":"/reference/print.summary.hgwrm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print summary of an hgwrm object. — print.summary.hgwrm","text":"x object returned summary.hgwrm(). decimal.fmt format string passing base::sprintf(). ... Arguments passed print.table.md col.sep Column seperator. Default \"\". header.sep Header seperator. Default \"-\". row.begin Character beginning row. Default col.sep. row.end Character ending row. Default col.sep. table.style Name pre-defined style. Possible values \"plain\", \"md\" \"latex\". Default \"plain\".","code":""},{"path":"/reference/print.summary.hgwrm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print summary of an hgwrm object. — print.summary.hgwrm","text":"return.","code":""},{"path":[]},{"path":"/reference/print.summary.hgwrm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Print summary of an hgwrm object. — print.summary.hgwrm","text":"","code":"data(multisampling) model <- hgwr(formula = y ~ L(g1 + g2) + x1 + (z1 | group),               data = multisampling$data,               coords = multisampling$coords,               bw = 10) summary(model) #> Hierarchical and geographically weighted regression model #> ========================================================= #> Formula: y ~ L(g1 + g2) + x1 + (z1 | group) #>  Method: Back-fitting and Maximum likelihood #>    Data: multisampling$data #>  #> Diagnostics #> ----------- #>  Rsquared  #>  0.647031  #>  #> Scaled residuals #> ---------------- #>        Min         1Q     Median        3Q       Max  #>  -5.456449  -1.215641  -0.072241  1.246953  5.329316  #>  #> Other Information #> ----------------- #> Number of Obs: 484 #>        Groups: group , 16"},{"path":"/reference/print.table.md.html","id":null,"dir":"Reference","previous_headings":"","what":"Print a character matrix as a table. — print.table.md","title":"Print a character matrix as a table. — print.table.md","text":"Print character matrix table.","code":""},{"path":"/reference/print.table.md.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print a character matrix as a table. — print.table.md","text":"","code":"# S3 method for table.md print(   x,   col.sep = \"\",   header.sep = \"\",   row.begin = \"\",   row.end = \"\",   table.style = c(\"plain\", \"md\", \"latex\"),   ... )"},{"path":"/reference/print.table.md.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print a character matrix as a table. — print.table.md","text":"x character matrix. col.sep Column seperator. Default \"\". header.sep Header seperator. Default \"-\". row.begin Character beginning row. Default col.sep. row.end Character ending row. Default col.sep. table.style Name pre-defined style. Possible values \"plain\", \"md\" \"latex\". Default \"plain\". ... Additional style control arguments.","code":""},{"path":"/reference/print.table.md.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print a character matrix as a table. — print.table.md","text":"return.","code":""},{"path":"/reference/print.table.md.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Print a character matrix as a table. — print.table.md","text":"table.style specified, col.sep, header.sep, row.begin row.end take effects. function automatically set values. possible value table.style, corresponding style settings shown following table. function, characters right padded spaces.","code":""},{"path":[]},{"path":"/reference/residuals.hgwrm.html","id":null,"dir":"Reference","previous_headings":"","what":"Get residuals. — residuals.hgwrm","title":"Get residuals. — residuals.hgwrm","text":"Get residuals.","code":""},{"path":"/reference/residuals.hgwrm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get residuals. — residuals.hgwrm","text":"","code":"# S3 method for hgwrm residuals(object, ...)"},{"path":"/reference/residuals.hgwrm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get residuals. — residuals.hgwrm","text":"object hgwrm object returned hgwr(). ... Parameter received functions.","code":""},{"path":"/reference/residuals.hgwrm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get residuals. — residuals.hgwrm","text":"vector consists residuals.","code":""},{"path":[]},{"path":"/reference/summary.hgwrm.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary an hgwrm object. — summary.hgwrm","title":"Summary an hgwrm object. — summary.hgwrm","text":"Summary hgwrm object.","code":""},{"path":"/reference/summary.hgwrm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary an hgwrm object. — summary.hgwrm","text":"","code":"# S3 method for hgwrm summary(object, ...)"},{"path":"/reference/summary.hgwrm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary an hgwrm object. — summary.hgwrm","text":"object hgwrm object returned hgwr(). ... arguments passed functions.","code":""},{"path":"/reference/summary.hgwrm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summary an hgwrm object. — summary.hgwrm","text":"list containing summary informations hgwrm object following fields. diagnostic list diagnostic information. random.stddev standard deviation random effects. random.corr correlation matrix random effects. residuals residual vector.","code":""},{"path":[]},{"path":"/reference/wuhan.hp.html","id":null,"dir":"Reference","previous_headings":"","what":"Wuhan Second-hand House Price and POI Data (DataFrame) — wuhan.hp","title":"Wuhan Second-hand House Price and POI Data (DataFrame) — wuhan.hp","text":"data set second-hand house price Wuhan, China collected 2018.","code":""},{"path":"/reference/wuhan.hp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Wuhan Second-hand House Price and POI Data (DataFrame) — wuhan.hp","text":"","code":"data(multisampling)"},{"path":"/reference/wuhan.hp.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Wuhan Second-hand House Price and POI Data (DataFrame) — wuhan.hp","text":"list two items called \"data\" \"coords\". Item \"data\" data frame 13862 second-hand properties 779 neighbourhoods following 22 variables. Price House price per square metre. Floor.High 1 property high floor, otherwise 0. Floor.Low 1 property low floor, otherwise 0. Decoration.Fine 1 property well decorated, otherwise 0. PlateTower 1 property plate-tower type, otherwise 0. Steel 1 property 'steel' structure, otherwise 0. BuildingArea Building area square metres. Fee Management fee per square meter per month. d.Commercial Distance nearest commercial area. d.Greenland Distance nearest green land. d.Water Distance nearest river lake. d.University Distance nearest university. d.HighSchool Distance nearest high school. d.MiddleSchool Distance nearest middle school. d.PrimarySchool Distance nearest primary school. d.Kindergarten Distance nearest kindergarten. d.SubwayStation Distance nearest subway station. d.Supermarket Distance nearest supermarket. d.ShoppingMall Distance nearest shopping mall. lon Longitude coordinates (Projected CRS: EPSG 3857). lat Latitude coordinates (Projected CRS: EPSE 3857). group Group id sample. following variables group level: - Fee - d.Commercial - d.Greenland - d.Water - d.University - d.HighSchool - d.MiddleSchool - d.PrimarySchool - d.Kindergarten - d.SubwayStation - d.Supermarket - d.ShoppingMall follwoing variables sample level: - Price - Floor.High - Floor.Low - Decoration.Fine - PlateTower - Steel - BuildingArea Item \"coords\" 779--2 matrix coordinates neighbourhoods.","code":""},{"path":"/reference/wuhan.hp.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Wuhan Second-hand House Price and POI Data (DataFrame) — wuhan.hp","text":"Yigong Hu yigong.hu@bristol.ac.uk","code":""},{"path":"/reference/wuhan.hp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Wuhan Second-hand House Price and POI Data (DataFrame) — wuhan.hp","text":"","code":"if (FALSE) { data(wuhan.hp) hgwr(   formula = Price ~ L(d.Water + d.Commercial + d.PrimarySchool +             d.Kindergarten + Fee) + BuildingArea + (Floor.High | group),   data = wuhan.hp$data,   coords = wuhan.hp$coords, bw = 50, kernel = \"bisquared\") }"},{"path":"/news/index.html","id":"version-031","dir":"Changelog","previous_headings":"","what":"Version 0.3.1","title":"Version 0.3.1","text":"Feature: support sf objects Feature: enable set intercept Update: wuhan.hp data","code":""},{"path":"/news/index.html","id":"version-030","dir":"Changelog","previous_headings":"","what":"Version 0.3.0","title":"Version 0.3.0","text":"Update: wuhan.hp data Fix: fill parameter cat function","code":""},{"path":"/news/index.html","id":"version-023","dir":"Changelog","previous_headings":"","what":"Version 0.2.3","title":"Version 0.2.3","text":"Feature: new data sets Fix: rename multisampling$coord coords Fix: data document errors Fix: error wuhan.hp data Fix: use group index instead original value Fix: don’t run examples large data set","code":""},{"path":"/news/index.html","id":"version-022","dir":"Changelog","previous_headings":"","what":"Version 0.2.2","title":"Version 0.2.2","text":"Fix: use gsl-config --libs configure script","code":""},{"path":"/news/index.html","id":"version-021","dir":"Changelog","previous_headings":"","what":"Version 0.2.1","title":"Version 0.2.1","text":"Fix: C++ compile errors Fix: first sentence description field Fix: error R function coef.hgwrm Fix: missing .Rd files","code":""},{"path":"/news/index.html","id":"version-020","dir":"Changelog","previous_headings":"","what":"Version 0.2.0","title":"Version 0.2.0","text":"Feature: R interface set kernel Fix: incompactible generic function definations Fix: R check warnings","code":""},{"path":"/news/index.html","id":"version-010","dir":"Changelog","previous_headings":"","what":"Version 0.1.0","title":"Version 0.1.0","text":"Feature: R function hgwr","code":""}]
